import{h as ae,r as a,b as le,p as ie,j as e,B as ne,C as oe,q as F,P as de}from"./index-B-Z7yNlO.js";import{H as ce}from"./header-only-layout-CxxpAl_x.js";import{O as me}from"./OrderApi-CGMXsDX2.js";import{B as ue}from"./badge-rRRKVG41.js";import{C as he}from"./checkbox-CKpr-sF7.js";import{E as xe,a as pe,b as je,T as fe,c as ge,d as Se,D as ve}from"./data-table-pagination-jAdcHPHB.js";import{I as be}from"./input-CYr9y3VT.js";import{L as ye}from"./form-qz6utvQt.js";import{S as b,a as y,b as N,c as T,d as r}from"./select-DzdYbDWA.js";import{T as Ne,a as Te,b as C,c as i,d as Ce,e as l}from"./table-C-m2lx9N.js";import{T as Oe,a as De,b as Re,c as we}from"./tooltip-7LS4ezhM.js";import{D as A}from"./date-picker-C9W7qmUe.js";import{D as Pe}from"./download-BCHcyCA6.js";import{S as Be}from"./search-Du6dQxSa.js";import{u as Ie}from"./use-authenticated-Pr-DwbI4.js";import{L as Le}from"./Loading-C-SdFTii.js";import"./header-B0B3aqNt.js";import"./PersonApi-XJxwtgYA.js";import"./dropdown-menu-C7Ce47-G.js";import"./index-DhZ6krBt.js";import"./index-Cy9rQrAY.js";import"./Combination-BYZD_UMj.js";import"./index-TuNWgU8l.js";import"./index-CbrVU0fF.js";import"./index-cmrrDq_5.js";import"./check-CNKoX3WN.js";import"./chevron-right-BPcmLOb9.js";import"./dialog-BFKdIpyt.js";import"./x-DRPXTlq9.js";import"./separator-DDFY1sx8.js";import"./search-provider-DlORLCzO.js";import"./command-CsEG0zEQ.js";import"./building-2-CN27OJy-.js";import"./scroll-area-Bc8fPTN3.js";import"./index-BBPgPd72.js";import"./index-D5jFdGIL.js";import"./chevron-left-DoAt43BC.js";import"./chevron-down-lARmK8u4.js";import"./popover-DfmavNz2.js";function Fe(){const{user:n}=ae(s=>s.auth),[d,E]=a.useState(!0),[h,O]=a.useState(void 0),[x,D]=a.useState(void 0),[o,M]=a.useState("7"),[p,k]=a.useState("all"),[c,$]=a.useState("all"),[j,V]=a.useState("all"),[R,w]=a.useState(1),[f,q]=a.useState(""),[P,H]=a.useState([]),[B,Y]=a.useState(0),[Q,g]=a.useState(!1),I=20,U=Math.ceil(B/I),W=le(),_=s=>s.includes("Review")||s.includes("Rejected")?"destructive":s.includes("Shipped")||s.includes("Completed")?"default":s.includes("Received")?"secondary":s.includes("Processing")?"outline":"secondary",z=async()=>{if(n){g(!0);try{const s=new me,t=h?F(h):void 0,v=x?F(x):void 0,m={smartFilter:f,filterByWaitingOnMe:d,filterByDealershipId:n?.person?.type==="Dealership"?n?.person?.dealership.id:void 0};p!=="all"&&(m.filterByPartsOrderNumber=parseInt(p)),c!=="all"&&(m.filterByStatus=c),j!=="all"&&(m.filterByRegionId=parseInt(j));const S=de.create(m);t&&(S.dateSubmittedFrom=t),v&&(S.dateSubmittedTo=v),s.partsOrderSearch(S,{status200:u=>{H(u.partOrders||[]),Y(u.totalItemCount||0),g(!1)},error:u=>{g(!1)},status403:u=>{g(!1)}})}catch{g(!1)}}};a.useEffect(()=>{if(!n)return;const s=setTimeout(()=>{z()},f?500:0);return()=>clearTimeout(s)},[f,d,p,c,j,o,h,x,R,n]),a.useEffect(()=>{w(1)},[f,d,p,c,j,o,h,x]),a.useEffect(()=>{if(o!=="custom"){const{from:s,to:t}=ie(o);O(s),D(t)}},[o]);const L=s=>{if(!s)return"--";const t=typeof s=="string"?new Date(s):s;return isNaN(t.getTime())?"--":t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})},G=s=>s===0?"Parts Order":s===1?"Supplement 1":s===2?"Supplement 2":`Supplement ${s}`;return e.jsx("div",{className:"min-h-scree",children:e.jsxs("div",{className:"bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Parts Order List"}),e.jsxs(ne,{children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Report"]})]}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 lg:flex-row lg:items-center",children:[e.jsxs("div",{className:"relative max-w-md flex-1",children:[e.jsx(Be,{className:"text-muted-foreground absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2"}),e.jsx(be,{value:f,onChange:s=>q(s.target.value),placeholder:"Filter by RO#, Sales Order #, VIN, Shop, Dealer",className:"pl-10"})]}),n?.person?.type==="Csr"||n?.person?.type==="FieldStaff"&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{id:"my-orders",checked:d,onCheckedChange:s=>E(s),className:"bg-muted rounded-full"}),e.jsx(ye,{htmlFor:"my-orders",className:"flex cursor-pointer items-center gap-2 text-sm font-medium",children:"Only View Parts Orders that are waiting On Me"})]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs(b,{value:p,onValueChange:s=>k(s),children:[e.jsx(y,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"Type of Order"})}),e.jsxs(T,{children:[e.jsx(r,{value:"all",children:"All Types"}),e.jsx(r,{value:"0",children:"original Parts Order"}),e.jsx(r,{value:"1",children:"Supplement #1"}),e.jsx(r,{value:"2",children:"Supplement #2"}),e.jsx(r,{value:"3",children:"Supplement #3"})]})]}),e.jsxs(b,{value:c,onValueChange:s=>$(s),children:[e.jsx(y,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"Status"})}),e.jsxs(T,{children:[e.jsx(r,{value:"all",children:"All Status"}),e.jsx(r,{value:"csr-Review",children:"CSR Review"}),e.jsx(r,{value:"csr-rejected",children:"CSR Rejected"}),e.jsx(r,{value:"dealer-processing",children:"Dealer Processing"}),e.jsx(r,{value:"dealer-shipped",children:"Dealer Shipped"}),e.jsx(r,{value:"shop-received",children:"Shop Received"}),e.jsx(r,{value:"repair-completed",children:"Repair Completed"})]})]}),e.jsxs(b,{value:j,onValueChange:s=>V(s),children:[e.jsx(y,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"CSR Region"})}),e.jsxs(T,{children:[e.jsx(r,{value:"all",children:"All Regions"}),n?.regions?.map(s=>e.jsx(r,{value:s.id?.toString()||"",children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Date Submitted Range"}),e.jsxs(b,{value:o,onValueChange:s=>M(s),children:[e.jsx(y,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"ALL Dates"})}),e.jsxs(T,{children:[e.jsx(r,{value:"7",children:"Past 7 days"}),e.jsx(r,{value:"30",children:"Past 30 Days"}),e.jsx(r,{value:"month-to-date",children:"Month-To-Date"}),e.jsx(r,{value:"quarter-to-date",children:"Quarter-To-Date"}),e.jsx(r,{value:"year-to-date",children:"Year-To-Date"}),e.jsx(r,{value:"last-month",children:"Last Month"}),e.jsx(r,{value:"last-quarter",children:"Last Quarter"}),e.jsx(r,{value:"last-year",children:"Last Year"}),e.jsx(r,{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"From"}),e.jsx(A,{disabled:o!=="custom",selected:h,onSelect:s=>O(s),placeholder:"Select from date"}),e.jsx("span",{className:"text-sm font-medium",children:"To"}),e.jsx(A,{disabled:o!=="custom",selected:x,onSelect:s=>D(s),placeholder:"Select to date"})]})]}),e.jsx("div",{className:"bg-background overflow-hidden rounded-lg border shadow-sm",children:e.jsxs(Ne,{children:[e.jsx(Te,{children:e.jsxs(C,{className:"bg-muted",children:[e.jsx(i,{className:"text-foreground font-semibold",children:"RO #"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Sales #"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Type"}),e.jsx(i,{className:"text-foreground font-semibold",children:"VIN"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Year/Make/Model"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Status"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Shop"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Dealer"}),e.jsx(i,{className:"text-foreground font-semibold",children:"CSR Region"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Date Completed"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Date Closed"})]})}),e.jsx(Ce,{children:Q?e.jsx(C,{children:e.jsx(l,{colSpan:11,className:"py-8 text-center",children:"loading..."})}):P.length===0?e.jsx(C,{children:e.jsx(l,{colSpan:11,className:"py-8 text-center",children:e.jsx(xe,{children:e.jsxs(pe,{children:[e.jsx(je,{variant:"icon",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(ge,{children:"No data to display"}),e.jsx(Se,{children:"There are no records in this table yet. Add your first entry to get started."})]})})})}):P.map(s=>{const t=s.repairOrder,v=t?.roNumber||"--",m=s.salesOrderNumber||"--",S=G(s.partsOrderNumber||0),u=t?.vin||"--",J=t&&`${t.year||""} ${t.make||""} ${t.model||""}`.trim()||"--",K=s.status||"--",X=t?.shop?`${t.shop.name||""} (${t.shop.id||""})`:"--",Z=t?.dealership?`${t.dealership.name||""} (${t.dealership.id||""})`:"--",ee=t?.region||"--",se=L(s.dateCreated),te=L(t?.dateClosed),re=t?.orderFromAlternateDealership||!1;return e.jsxs(C,{className:"hover:bg-muted/50",children:[e.jsx(l,{className:"cursor-pointer text-blue-600 hover:underline",onClick:()=>{W({to:"/repair_orders/$id",params:{id:s.repairOrder.id.toString()}})},children:v}),e.jsx(l,{children:m}),e.jsx(l,{children:S}),e.jsx(l,{className:"font-mono text-xs",children:u}),e.jsx(l,{children:J}),e.jsx(l,{children:e.jsx(ue,{variant:_(c),className:"whitespace-nowrap",children:K})}),e.jsx(l,{className:"text-sm",children:X}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[re&&e.jsx(Oe,{children:e.jsxs(De,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(oe,{className:"h-4 w-4 cursor-help text-yellow-600"})}),e.jsx(we,{children:e.jsx("p",{children:"Ordered from an alternate dealer"})})]})}),e.jsx("span",{className:"text-sm",children:Z})]})}),e.jsx(l,{children:ee}),e.jsx(l,{children:se}),e.jsx(l,{children:te||"--"})]},s.id)})})]})}),e.jsx(ve,{currentPage:R,totalPages:U,totalItems:B,itemsPerPage:I,onPageChange:w})]})]})})}function vs(){const{isAuthenticated:n,isLoading:d}=Ie();return d||!n?e.jsx(Le,{}):e.jsx(ce,{children:e.jsx(Fe,{})})}export{vs as component};
