import{h as G,r,b as J,p as K,j as e,B as U,q as p,s as W,i as X,O as Z}from"./index-bZPt74SL.js";import{u as ee}from"./use-authenticated-5oKGhwjr.js";import{L as te}from"./Loading-DvxbuYKm.js";import{O as se}from"./OrderApi-BoClc7Py.js";import{n as ae,R as re}from"./RepairOrderDialog-DDdr-kck.js";import{B as le}from"./badge-B483Njh1.js";import{C as ie}from"./checkbox-B0TIKdeQ.js";import{E as oe,a as ne,b as de,T as ce,c as me,d as ue,D as he}from"./data-table-pagination-DFlv6pI_.js";import{I as xe}from"./input-W45EOFir.js";import{L as pe}from"./form-C97xBvhE.js";import{S as O,a as T,b as L,c as P,d as a}from"./select-iVvteLym.js";import{T as je,a as fe,b as I,c as i,d as ge,e as o}from"./table-CDOYvhfH.js";import{D as F}from"./date-picker-HHB7J9Gf.js";import{P as ve}from"./plus-hKtGnEnx.js";import{S as be}from"./search-DHWuWzUR.js";import{T as Se}from"./confirm-dialog-CiE2ZAWb.js";import"./OrganizationApi-DLOiAKOQ.js";import"./Combination-C2X8UjKH.js";import"./index-BAv-q7Sn.js";import"./index-BMiWLKrh.js";import"./use-dialog-with-confirm-JhGjfUMb.js";import"./dialog-DyU8MlPO.js";import"./index-CJ8ye8BA.js";import"./x-BdNzPY10.js";import"./separator-AAFKv4Ad.js";import"./index-DQajRILt.js";import"./check-D9nIkqgl.js";import"./chevron-left-BFQH7A4v.js";import"./chevron-right-BMMQv83b.js";import"./index-BDNPEbHM.js";import"./index-B5XdlCk6.js";import"./chevron-down-DacainfD.js";import"./popover-Xpze6ip0.js";const Ne=l=>l.includes("Rejected")?"destructive":l.includes("Review")?"secondary":l.includes("Processing")?"outline":l.includes("Shipped")?"default":"secondary";function Re(){const{user:l}=G(s=>s.auth),[n,m]=r.useState(void 0),[j,k]=r.useState([]),[u,S]=r.useState(void 0),[N,R]=r.useState(1),h=20,[y,A]=r.useState(j.length||0),E=Math.ceil(y/h),C=(N-1)*h,B=C+h,V=j.slice(C,B),[M,w]=r.useState(!1),[f,q]=r.useState(!0),[g,$]=r.useState("all"),[x,H]=r.useState(""),[d,Y]=r.useState("all"),[Q,_]=r.useState(void 0),D=async()=>{try{const s=new se,t=l?.person?.shop?.id;if(t===null)return;const v=g==="all"?void 0:g,c=W.create({shopId:t,smartFilter:x||void 0,filterByStatus:v,showRepairCompleted:f,dateLastSubmittedFrom:n,dateLastSubmittedTo:u});c.dateLastSubmittedFrom&&(c.dateLastSubmittedFrom=p(n)),c.dateLastSubmittedTo&&(c.dateLastSubmittedTo=p(u)),s.repairOrderSearch(c,{status200:b=>{k(b.repairOrders),A(b.totalItemCount||0)},error:b=>{}})}catch{}},z=J();return r.useEffect(()=>{if(!l)return;R(1);const s=setTimeout(()=>{D()},x?500:0);return()=>clearTimeout(s)},[x,g,f,n,u,l]),r.useEffect(()=>{if(d!=="custom"){const{from:s,to:t}=K(d);m(s),S(t)}},[d]),e.jsxs("div",{className:"bg-background min-h-screen",children:[e.jsx("img",{src:ae,alt:"Repair Order List",className:"h-full w-full object-cover"}),e.jsx("div",{className:"bg-background border-b",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Repair Order List"}),e.jsxs(U,{variant:"default",onClick:()=>{w(!0),_(void 0)},children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"New Repair Order"]})]})}),e.jsx(re,{open:M,onOpenChange:w,onSuccess:s=>{D()},initialData:Q}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsxs("div",{className:"lg:items-cente mb-6 flex flex-col items-center gap-4 lg:flex-row",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(be,{className:"text-muted-foreground absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2"}),e.jsx(xe,{value:x,onChange:s=>H(s.target.value),placeholder:"Filter by RO#, Order #, VIN, Customer",className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs(O,{defaultValue:"all",onValueChange:s=>$(s),children:[e.jsx(T,{className:"w-48",children:e.jsx(L,{placeholder:"Status"})}),e.jsxs(P,{children:[e.jsx(a,{value:"all",children:"All Status"}),e.jsx(a,{value:"CsrReview",children:"CsrReview"}),e.jsx(a,{value:"CsrRejected",children:"CsrRejected"}),e.jsx(a,{value:"DealershipProcessing",children:"DealershipProcessing"}),e.jsx(a,{value:"DealershipShipped",children:"DealershipShipped"}),e.jsx(a,{value:"ShopReceived",children:"ShopReceived"}),e.jsx(a,{value:"RepairCompleted",children:"RepairCompleted"})]})]}),e.jsxs(O,{defaultValue:d,onValueChange:s=>Y(s),children:[e.jsx(T,{className:"w-40",children:e.jsx(L,{placeholder:"Date Range"})}),e.jsxs(P,{children:[e.jsx(a,{value:"all",children:"All Dates"}),e.jsx(a,{value:"7",children:"Past 7 days"}),e.jsx(a,{value:"30",children:"Past 30 Days"}),e.jsx(a,{value:"month-to-date",children:"Month-To-Date"}),e.jsx(a,{value:"quarter-to-date",children:"Quarter-To-Date"}),e.jsx(a,{value:"year-to-date",children:"Year-To-Date"}),e.jsx(a,{value:"last-month",children:"Last Month"}),e.jsx(a,{value:"last-quarter",children:"Last Quarter"}),e.jsx(a,{value:"last-year",children:"Last Year"}),e.jsx(a,{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"From"}),e.jsx(F,{selected:n,disabled:d!="custom",onSelect:s=>m(s),placeholder:"Select from date"}),e.jsx("span",{className:"text-sm font-medium",children:"To"}),e.jsx(F,{selected:u,disabled:d!="custom",onSelect:s=>S(s),placeholder:"Select to date"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{id:"show-completed",checked:f,onCheckedChange:s=>q(s),className:"rounded-full"}),e.jsx(pe,{htmlFor:"show-completed",className:"cursor-pointer text-sm font-medium",children:"Show Repair Completed"})]})]})]}),j.length===0?e.jsx("div",{children:e.jsx(oe,{children:e.jsxs(ne,{children:[e.jsx(de,{variant:"icon",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(me,{children:"No data to display"}),e.jsx(ue,{children:"There are no records in this table yet. Add your first entry to get started."})]})})}):e.jsxs("div",{children:[e.jsx("div",{className:"bg-card overflow-hidden rounded-lg border shadow-sm",children:e.jsxs(je,{children:[e.jsx(fe,{children:e.jsxs(I,{className:"bg-muted",children:[e.jsx(i,{className:"text-foreground font-semibold",children:"RO #"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Order #"}),e.jsx(i,{className:"text-foreground font-semibold",children:"VIN"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Year/Make/Model"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Status"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Customer"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Date Submitted"}),e.jsx(i,{className:"text-foreground font-semibold",children:"Date Completed"})]})}),e.jsx(ge,{children:V.map(s=>{const t=s,v=t.year&&t.make&&t.model?`${t.year} ${t.make} ${t.model}`:"--";return e.jsxs(I,{className:"hover:bg-muted/50",children:[e.jsx(o,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.hasAlert&&e.jsx(Se,{className:"text-destructive h-4 w-4"}),e.jsx("span",{className:"cursor-pointer text-blue-600 hover:underline",onClick:()=>{z({to:"/repair_orders/$id",params:{id:t.id.toString()}})},children:t.roNumber||"--"})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-1",children:t.salesOrderNumber?e.jsx("div",{children:t.salesOrderNumber}):e.jsx("div",{children:"--"})})}),e.jsx(o,{className:"font-mono text-sm",children:t.vin||"--"}),e.jsx(o,{children:v}),e.jsx(o,{children:e.jsx(le,{variant:Ne(t.status||""),className:"whitespace-nowrap",children:t.status||"--"})}),e.jsx(o,{children:t.customer||"--"}),e.jsx(o,{children:p(t.dateLastSubmitted)}),e.jsx(o,{className:"text-muted-foreground",children:p(t.dateClosed)})]},t.id||t.roNumber)})})]})}),e.jsx(he,{currentPage:N,totalPages:E,totalItems:y,itemsPerPage:h,onPageChange:R})]})]})]})}function at(){const{isAuthenticated:l,isLoading:n}=ee(),m=X();return n||!l?e.jsx(te,{}):m.pathname==="/repair_orders"?e.jsx(Re,{}):e.jsx(Z,{})}export{at as component};
