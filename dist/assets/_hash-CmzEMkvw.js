import{a as L,b as k,r as i,aH as I,h as E,t,A as q,j as s,l as H,B as U,aM as z}from"./index-DiI2ffAh.js";import{I as o}from"./input-anrjtq5m.js";import{L as l}from"./form-BztM4JIr.js";import{L as M}from"./Loading-QGL_XBaH.js";import{H as B,U as V,S as $,L as O}from"./header-BJ4bOhv6.js";import{E as P,a as S}from"./eye-Depk1M7T.js";import"./index-B9OW1ajA.js";import"./PersonApi-CgbCoTOu.js";import"./dropdown-menu-DS9Dg1PJ.js";import"./index-BesrJGlS.js";import"./Combination-D_vfDq5J.js";import"./index-B0ORnztA.js";import"./index-lW_6OgVn.js";import"./index-DTR4e_QT.js";import"./check-Ca0fbDYF.js";import"./chevron-right-B2dPWAbi.js";import"./dialog-BfbMbQ8-.js";import"./x-DoFJH5Nd.js";import"./separator-unOUWFl-.js";import"./badge-CmxtL1uP.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],D=L("map-pin",_);function J(){const w=k(),[d,n]=i.useState(!1),[a,b]=i.useState({email:"",firstName:"",lastName:"",shopName:"",shopNumber:"",shopAddress:"",password:"",confirmPassword:""}),{id:f,hash:x,guid:g}=I({from:"/registration/complete/$id/$guid/$hash"}),[u,C]=i.useState(!1),[p,A]=i.useState(!1),[F,h]=i.useState(!0),y=new q,{auth:N}=E(),j=i.useRef(!1);i.useEffect(()=>{if(!j.current){if(!f||!g||!x){t.error("Invalid registration link parameters."),h(!1);return}j.current=!0,y.sessionCreate(f,g,x,{status200:e=>{if(e){N.setUser(e);const r=e.person?.shop||e.person?.dealership,c=[r?.address,r?.city,r?.state,r?.zip].filter(Boolean).join(", ");b({email:e.person?.email||"",firstName:e.person?.firstName||"",lastName:e.person?.lastName||"",shopName:r?.name||"",shopNumber:e.person?.shop?.shopNumber||e.person?.dealership?.dealershipNumber||"",shopAddress:c||"",password:"",confirmPassword:""})}h(!1)},status404:()=>{t.error("Registration link is invalid or has expired."),h(!1)},error:()=>{t.error("Failed to validate reset link. Please try again."),h(!1),j.current=!1}},null)}},[f,g,x]);const v=(e,r)=>{b(m=>({...m,[e]:r}))},R=async e=>{if(e.preventDefault(),a.password!==a.confirmPassword){t.error("Passwords do not match.");return}if(a.password.length<8){t.error("Password must be at least 8 characters.");return}n(!0);try{const r=z.create({firstName:a.firstName,lastName:a.lastName,newPassword:a.password});y.registrationComplete(r,{status200:()=>{N.reset(),t.success("Registration completed successfully!"),w({to:"/login",replace:!0}),n(!1)},status409:()=>{n(!1)},error:m=>{const c=m?.message||String(m);if(c.includes("JSON.parse")||c.includes("unexpected character")||c.includes("successful operation")){N.reset(),t.success("Registration completed successfully!"),w({to:"/login",replace:!0}),n(!1);return}n(!1)}})}catch{t.error("Failed to reset password. Please try again."),n(!1)}};return F?s.jsx(M,{}):s.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[s.jsx(B,{isShowUser:!1}),s.jsx("div",{className:"bg-primary text-primary-foreground relative mt-12 h-32 lg:h-40",children:s.jsx("img",{src:H,alt:"New Shop User Registration",className:"absolute inset-0 h-full w-full object-cover opacity-70",loading:"lazy"})}),s.jsx("div",{className:"flex flex-1 items-start justify-center px-4 py-8 lg:py-12",children:s.jsxs("form",{onSubmit:R,className:"w-full max-w-4xl space-y-10",children:[s.jsxs("section",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(V,{className:"text-foreground h-6 w-6"}),s.jsx("h2",{className:"text-foreground text-xl font-semibold",children:"Personal Information"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"email",className:"text-foreground text-sm font-medium",children:"Email"}),s.jsx(o,{id:"email",type:"email",value:a.email,className:"bg-muted h-12 rounded-lg",disabled:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"firstName",className:"text-foreground text-sm font-medium",children:"First Name"}),s.jsx(o,{id:"firstName",value:a.firstName,className:"bg-muted h-12 rounded-lg",disabled:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"lastName",className:"text-foreground text-sm font-medium",children:"Last Name"}),s.jsx(o,{id:"lastName",value:a.lastName,className:"bg-muted h-12 rounded-lg",disabled:!0})]})]})]})]}),s.jsxs("section",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx($,{className:"text-foreground h-6 w-6"}),s.jsx("h2",{className:"text-foreground text-xl font-semibold",children:"Shop Information"})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"shopName",className:"text-foreground text-sm font-medium",children:"Name"}),s.jsx(o,{id:"shopName",value:a.shopName,className:"bg-muted h-12 rounded-lg",disabled:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"shopNumber",className:"text-foreground text-sm font-medium",children:"Number"}),s.jsx(o,{id:"shopNumber",value:a.shopNumber,className:"bg-muted h-12 rounded-lg",disabled:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"shopAddress",className:"text-foreground text-sm font-medium",children:"Address"}),s.jsxs("div",{className:"relative",children:[s.jsx(D,{className:"text-muted-foreground absolute top-3.5 left-3 h-5 w-5"}),s.jsx(o,{id:"shopAddress",value:a.shopAddress,className:"bg-muted h-12 rounded-lg pl-11",disabled:!0})]})]})]}),s.jsxs("section",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(O,{className:"text-foreground h-6 w-6"}),s.jsx("h2",{className:"text-foreground text-xl font-semibold",children:"Password"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"password",className:"text-foreground text-sm font-medium",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(o,{id:"password",type:u?"text":"password",placeholder:"Enter your password",className:"h-12 rounded-lg focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:a.password,onChange:e=>v("password",e.target.value),required:!0,disabled:d}),s.jsx("button",{type:"button",onClick:()=>C(!u),className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-3 -translate-y-1/2 transition-colors",disabled:d,"aria-label":u?"Hide password":"Show password",children:u?s.jsx(P,{className:"h-5 w-5"}):s.jsx(S,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"confirmPassword",className:"text-foreground text-sm font-medium",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(o,{id:"confirmPassword",type:p?"text":"password",placeholder:"Confirm your password",className:"h-12 rounded-lg pr-12 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:a.confirmPassword,onChange:e=>v("confirmPassword",e.target.value),required:!0,disabled:d}),s.jsx("button",{type:"button",onClick:()=>A(!p),className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-3 -translate-y-1/2 transition-colors",disabled:d,"aria-label":p?"Hide password":"Show password",children:p?s.jsx(P,{className:"h-5 w-5"}):s.jsx(S,{className:"h-5 w-5"})})]})]})]})]}),s.jsx("div",{className:"flex justify-end pt-6",children:s.jsx(U,{type:"submit",variant:"default",className:"h-12 rounded-full px-8 font-medium shadow-md transition-all",disabled:d,children:d?"Completing...":"Complete Registration"})})]})})]})}const us=J;export{us as component};
