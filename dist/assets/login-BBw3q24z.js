import{i as P,e as R,u as D,b as q,r,j as e,k as F,L as B,B as M,t as l,m as U,A as $}from"./index-BLoyOwMx.js";import{C as z}from"./checkbox-BVEvYVsG.js";import{I as j}from"./input-CT4loVds.js";import{L as g}from"./label-BkpQnFCu.js";import{H,L as W}from"./header-CobFEfmz.js";import{u as O,M as _}from"./use-redirect-if-authenticated-CQ_6x3FX.js";import{E as G,a as J}from"./eye-Cz6Fo_TK.js";import"./index-dZd-BMAV.js";import"./index-2dDBcqJ5.js";import"./index-DqhBytGz.js";import"./check-C049BlOK.js";import"./dropdown-menu-e4nvVUns.js";import"./index-QFuqZRo-.js";import"./Combination-BAMHyZ9Y.js";import"./index-QepcOU6L.js";import"./index-BrrJFWkZ.js";import"./chevron-right-QEi6ffMl.js";import"./form-Bv7oDV2N.js";import"./dialog-Bc8KpLtT.js";import"./x-BrS1Xc2W.js";import"./separator-BqvfaLvR.js";import"./user-CbhXsA-X.js";import"./badge-MpNgBHQk.js";import"./Loading-D1N6TMv6.js";function K(){const b=P("login","_a.png"),w=R(),{redirect:n}=D({from:"/(auth)/login"}),{auth:v}=q(),[t,a]=r.useState(!1),[c,L]=r.useState(""),[u,S]=r.useState(""),[p,k]=r.useState(!1),{isLoading:x,LoadingComponent:y}=O(),[h,A]=r.useState(!1),[C,o]=r.useState(!1);if(r.useEffect(()=>{!h&&!x&&A(!0)},[x,h]),x&&!h&&y)return e.jsx(y,{});const E=async i=>{if(i.preventDefault(),i.stopPropagation(),!(t||C)){if(!c||!u){l.error("Please enter email and password");return}o(!0),a(!0);try{const m=new U;m.email=c.trim(),m.password=u,new $().login(m,{status200:d=>{const s=d.person;if(!s){l.error("Invalid session data"),a(!1),o(!1);return}const I={id:s.id||0,email:s.email||c,firstName:s.firstName||"",lastName:s.lastName||"",type:s.type||"Shop",status:s.status||"Active",shopName:s.shop?.name,shopNumber:s.shop?.shopNumber,dealershipName:s.dealership?.name,dealershipNumber:s.dealership?.dealershipNumber};v.setUser(I),l.success(`Welcome back, ${s.firstName||c}!`),a(!1),o(!1);let f="/";if(n)try{const N=new URL(n);f=N.pathname+N.search}catch{f=n.startsWith("/")?n:`/${n}`}w({to:f,replace:!0})},error:d=>{console.error("Login error:",d),l.error("Network error, please try again"),a(!1),o(!1)},else:(d,s)=>{console.error("Login error:",d,s),l.error("Network error, please try again"),a(!1),o(!1)}},null)}catch(m){console.error("Login error:",m),l.error("An unexpected error occurred"),a(!1),o(!1)}}};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[e.jsx(H,{isShowUser:!1}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("div",{className:"flex flex-col items-center justify-center px-6 py-12 lg:py-16",style:{backgroundImage:`url(${F})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:b?e.jsx("img",{loading:"lazy",src:b,alt:"logo",className:"mx-auto h-36 w-auto max-w-lg space-y-8 text-center drop-shadow-xl lg:h-56"}):null}),e.jsx("div",{className:"flex flex-1 items-start justify-center  px-1 py-2 lg:py-12",children:e.jsxs("div",{className:"w-full max-w-md p-8 lg:p-10",children:[e.jsx("h2",{className:"mb-10 text-center text-3xl font-bold text-primary lg:text-4xl",children:"Login"}),e.jsxs("form",{className:"space-y-7",onSubmit:E,children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"email",className:"text-base font-medium text-muted-foreground",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute top-1/2 left-4 h-5 w-5 -translate-y-1/2 text-muted-foreground"}),e.jsx(j,{id:"email",type:"email",placeholder:"Enter your email",className:"h-14 rounded-full text-muted-foreground border-gray-300 pl-12 text-base focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:c,onChange:i=>L(i.target.value),required:!0,disabled:t})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{htmlFor:"password",className:"text-base font-medium text-muted-foreground",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute top-1/2 left-4 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx(j,{id:"password",type:p?"text":"password",placeholder:"Enter your password",className:"h-14 rounded-full text-muted-foreground border-gray-300 pr-12 pl-12 text-base focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:u,onChange:i=>S(i.target.value),required:!0,disabled:t}),e.jsx("button",{type:"button",onClick:()=>k(!p),className:"absolute top-1/2 right-4 -translate-y-1/2  hover:text-gray-700",disabled:t,children:p?e.jsx(G,{className:"h-5 w-5"}):e.jsx(J,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{id:"remember",disabled:t,className:"cursor-pointer bg-muted"}),e.jsx(g,{htmlFor:"remember",className:"cursor-pointer font-normal text-gray-600",children:"Remember Me"})]}),e.jsx(B,{to:"/password/forgot",className:"font-medium text-red-600 transition-colors hover:text-red-700",children:"Forgot password"})]}),e.jsx(M,{type:"submit",className:"h-14 w-full rounded-full   text-base font-semibold text-muted shadow-md transition-all hover:bg-gray-900",disabled:t,children:t?"Logging in...":"Log in"})]}),e.jsxs("div",{className:"mt-10 text-center text-sm text-gray-600",children:[e.jsx("p",{className:"mb-3",children:"Don't have an account?"}),e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsx("a",{href:"/registration/shop",className:"font-medium text-cyan-600 transition-colors hover:text-cyan-700",children:"Register as Shop"}),e.jsx("a",{href:"/registration/dealership",className:"font-medium text-cyan-600 transition-colors hover:text-cyan-700",children:"Register as Dealer"})]})]})]})})]})]})}const ye=K;export{ye as component};
