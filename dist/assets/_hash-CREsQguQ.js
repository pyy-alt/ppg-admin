import{m as R,b as I,h as q,aC as U,r as a,A,t,j as e,L as d,n as B,B as V,aK as E}from"./index-AEJqH7X3.js";import{I as w}from"./input-CmFiA4aS.js";import{L as j}from"./form-B-9o-mGd.js";import{L as F}from"./Loading-kNJkgnPR.js";import{H as y,L as N}from"./header--K_aAJIq.js";import"./index-DHA2SvWU.js";import"./dropdown-menu-CYqkwGZA.js";import"./index-CbndJyd8.js";import"./Combination-sHhQTmF-.js";import"./index-DJLl_0xC.js";import"./index-DyU3SkHl.js";import"./index-DwAwodCa.js";import"./check-Cpyw8Zmg.js";import"./chevron-right-PyYQBaYj.js";import"./PersonApi-CTYx9n-F.js";import"./dialog-VSGVEgcW.js";import"./x-jFcJKXCZ.js";import"./separator-Dq2d3GQ3.js";import"./badge-DYcg5A6J.js";const v=new A;function $(){const c=R("login","_a.png"),b=I(),{auth:u}=q(),{id:m,guid:f,hash:x}=U({from:"/password/reset/$id/$guid/$hash"}),[r,n]=a.useState(!1),[k,l]=a.useState(!0),[L,p]=a.useState(!1),[o,P]=a.useState(""),[h,S]=a.useState(""),i=a.useRef(!1);a.useEffect(()=>{i.current||(i.current=!0,v.sessionCreate(m,f,x,{status200:s=>{u.setUser(s),p(!0),l(!1)},status404:()=>{t.error("Reset link is invalid or has expired."),p(!1),l(!1)},error:()=>{t.error("Failed to validate reset link. Please try again."),l(!1),i.current=!1}},null))},[m,f,x]);const C=async s=>{if(s.preventDefault(),o!==h){t.error("Passwords do not match.");return}if(o.length<8){t.error("Password must be at least 8 characters.");return}n(!0);try{const g=E.create({newPassword:o});v.updatePassword(g,{status200:()=>{t.success("Your password has been successfully updated."),u.reset(),b({to:"/login"}),n(!1)}})}catch{t.error("Failed to reset password. Please try again."),n(!1)}};return k?e.jsx(F,{}):L?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(y,{isShowUser:!1}),e.jsx("div",{style:{backgroundImage:`url(${B})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},className:"flex flex-col items-center justify-center px-6 py-12 lg:py-16",children:c?e.jsx("img",{loading:"lazy",src:c,alt:"logo",className:"mx-auto h-36 w-auto max-w-lg space-y-8 text-center drop-shadow-xl lg:h-56"}):null}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4 py-8",children:e.jsx("div",{className:"w-full max-w-md space-y-10",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("h1",{className:"text-foreground text-center text-3xl font-bold",children:"Change Password"}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"password",className:"text-foreground text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2"}),e.jsx(w,{id:"password",type:"password",placeholder:"Enter new password",className:"h-12 rounded-full pl-11 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:o,onChange:s=>P(s.target.value),required:!0,disabled:r})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirm",className:"text-foreground text-sm font-medium",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2"}),e.jsx(w,{id:"confirm",type:"password",placeholder:"Confirm new password",className:"h-12 rounded-full pl-11 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:h,onChange:s=>S(s.target.value),required:!0,disabled:r})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(d,{to:"/login",className:"text-sm font-medium text-cyan-600 transition-colors hover:text-cyan-700",children:"Back to Login"})}),e.jsx(V,{type:"submit",variant:"default",className:"h-12 w-full rounded-full font-medium shadow-md transition-all",disabled:r,children:r?"Updating...":"Update"})]})]})})})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(y,{isShowUser:!1}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"w-full max-w-md space-y-6 text-center",children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-muted-foreground",children:"The password reset link is invalid or has expired. Please request a new one."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(d,{to:"/password/forgot",className:"rounded-full px-4 py-2 transition-colors",children:"Request New Link"}),e.jsx(d,{to:"/login",className:"text-foreground hover:bg-muted/50 rounded-full border px-4 py-2 transition-colors",children:"Back to Login"})]})]})})]})}const re=()=>e.jsx($,{});export{re as component};
