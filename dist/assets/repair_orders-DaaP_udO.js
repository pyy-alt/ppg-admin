import{c as $,r as p,o as J,j as e,B as V,s as f,l as ee,O as se}from"./index-DvwH5F9Z.js";import{u as re}from"./use-authenticated-K5dGQO-R.js";import{L as ae}from"./Loading-DjNax36X.js";import{U as te,u as oe,n as le}from"./index-BmBXdz5l.js";import{B as ne}from"./badge-BzoErU6m.js";import{C as ce}from"./checkbox-CFvhohBt.js";import{I as M}from"./input-DYarJNKy.js";import{L as q}from"./label-BmEJJfe9.js";import{S as w,a as C,b as R,c as O,d as t}from"./select-BuvFGPx1.js";import{T as ie,a as de,b as Z,c as x,d as me,e as h}from"./table-D_efp4rg.js";import{u as xe,a as he,F as pe,b as g,c as v,d as N,e as b,f as P}from"./form-LyoIxO0u.js";import{D as ue,a as je,b as fe,c as ge,d as ve}from"./dialog-KCJIwJT-.js";import{S as _}from"./separator--YnZv5Zu.js";import{X as H}from"./x-2MONtELq.js";import{D as Ne}from"./data-table-pagination-D-B-r9oT.js";import{D as B}from"./date-picker-bodtIAsG.js";import{P as be}from"./plus-C8PZqeE8.js";import{S as ye}from"./search-B9Vx0tiV.js";import{T as Se}from"./triangle-alert-BK93d_iB.js";import"./Combination-BlpO5CDz.js";import"./index-DXAlcKWc.js";import"./index-DZNfOI6o.js";import"./index-Bu1cG3U1.js";import"./index-B3xR7uaR.js";import"./check-iYg700vF.js";import"./index-BdQq_4o_.js";import"./index-CdCeNaJ0.js";import"./index-D4oZXDqg.js";import"./chevron-down-B_aRXHqE.js";import"./chevron-left-s4SFUeO9.js";import"./chevron-right-DH-lXxLl.js";import"./popover-DydzuUMU.js";const we=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Ce=$("camera",we);const Re=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],T=$("file-text",Re);const Oe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],W=$("image",Oe),Fe=J({shopRO:f().min(1,"Shop RO # is required"),customer:f().min(1,"Customer name is required"),vin:f().min(17,"VIN must be 17 characters").max(17).optional().or(ee("")),make:f().optional(),year:f().optional(),model:f().optional(),orderFromDealership:f().min(1,"Order From Dealership is required")});function z({open:n,onOpenChange:l,onSuccess:A,initialData:o}){const c=!!o,[F,d]=p.useState([]),[u,y]=p.useState([]),a=xe({resolver:he(Fe),defaultValues:{shopRO:"",customer:"",vin:"",make:"",year:"",model:"",orderFromDealership:""}});p.useEffect(()=>{o?(a.reset({shopRO:o.shopRO,customer:o.customer,vin:o.vin||"",make:o.make||"",year:o.year||"",model:o.model||"",orderFromDealership:o.orderFromDealership||""}),d(o.measurementsFiles||[]),y(o.photoFiles||[])):(a.reset({shopRO:"",customer:"",vin:"",make:"",year:"",model:""}),d([]),y([]))},[o,a]);const I=s=>{console.log(c?"Updated Repair Order:":"New Repair Order:",s,{measurementsFiles:F,photoFiles:u}),A?.({...s,measurementsFiles:F,photoFiles:u}),j()},j=()=>{l(!1),setTimeout(()=>{a.reset(),d([]),y([])},200)},k=({title:s,icon:D,files:i,onFilesChange:r,accept:S})=>{const K=()=>{if(S){if(S.includes("image"))return{"image/*":[]};if(S.includes(".pdf"))return{"application/pdf":[".pdf"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]}}},{getRootProps:Q,getInputProps:Y,isDragActive:L}=oe({accept:K(),multiple:!0,onDrop:m=>{r([...i,...m])}});return e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{className:"text-base font-medium",children:s}),e.jsxs("div",{...Q(),className:`relative cursor-pointer rounded-lg border-2 border-dashed p-10 text-center transition-all duration-200 active:scale-[0.98] ${L?"border-primary bg-primary/10":"border-border bg-muted/50 hover:border-primary hover:bg-muted"}`,children:[e.jsx("input",{...Y()}),e.jsx(D,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:L?e.jsxs(e.Fragment,{children:["Drop your ",s.toLowerCase()," here..."]}):e.jsxs(e.Fragment,{children:["Drop your ",s.toLowerCase()," here or"," ",e.jsx("span",{className:"text-primary hover:underline",children:"click to browse"})]})}),e.jsxs(V,{variant:"ghost",size:"sm",className:"mt-4",type:"button",onClick:m=>{m.stopPropagation()},children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Open camera"]})]}),i.length>0&&e.jsx("div",{className:"space-y-2",children:i.map((m,E)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md bg-muted px-3 py-2 transition-colors hover:bg-muted/80",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.includes("Photo")?e.jsx(W,{className:"h-4 w-4"}):e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{className:"max-w-48 truncate text-sm text-primary",children:m.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[(m.size/1024/1024).toFixed(1)," MB"]})]}),e.jsx("button",{type:"button",onClick:X=>{X.stopPropagation(),r(i.filter((Pe,G)=>G!==E))},className:"rounded p-1 text-destructive transition-colors hover:bg-destructive/10 hover:text-destructive focus:ring-2 focus:ring-destructive focus:ring-offset-1 focus:outline-none","aria-label":`Remove ${m.name}`,children:e.jsx(H,{className:"h-4 w-4"})})]},`${m.name}-${E}-${m.size}`))})]})};return e.jsx(ue,{open:n,onOpenChange:j,children:e.jsxs(je,{className:"flex max-h-[90vh] flex-col sm:max-w-4xl",children:[e.jsxs(fe,{className:"flex-shrink-0",children:[e.jsx(ge,{className:"text-2xl font-semibold",children:c?"Edit Repair Order":"New Repair Order"}),e.jsx(_,{}),e.jsxs("button",{onClick:j,className:"ring-offset-background focus:ring-ring absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx("div",{className:"-mx-6 flex-1 overflow-y-auto scroll-smooth px-6 py-4",children:e.jsx(pe,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(I),className:"space-y-8 pb-4",id:"repair-order-form",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-foreground"}),e.jsx("h3",{className:"text-lg font-medium",children:"Repair Order Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(g,{control:a.control,name:"shopRO",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsxs(N,{children:["Shop RO #"," ",c&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(Read-only)"})]}),e.jsx(b,{children:e.jsx(M,{placeholder:"Enter Shop RO #",...s,disabled:c,className:c?"bg-muted":""})}),e.jsx("div",{className:"flex min-h-[20px] items-start",children:e.jsx(P,{})})]})}),e.jsx(g,{control:a.control,name:"customer",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsx(N,{children:"Customer"}),e.jsx(b,{children:e.jsx(M,{placeholder:"Customer name",...s})}),e.jsx("div",{className:"flex min-h-[20px] items-start",children:e.jsx(P,{})})]})}),e.jsx(g,{control:a.control,name:"orderFromDealership",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsx(N,{children:"Order From Dealership"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(b,{children:e.jsx(C,{className:"w-[250px]",children:e.jsx(R,{placeholder:"Select"})})}),e.jsxs(O,{children:[e.jsx(t,{value:"Pacific VW Motors",children:"Pacific VW Motors | 88321 (Assigned Dealer)"}),e.jsx(t,{value:"Pacific VW Motors",children:"Pacific VW Motors | 88321 (Assigned Dealer)"})]})]}),e.jsx("div",{className:"flex min-h-[20px] items-start",children:e.jsx(P,{})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(g,{control:a.control,name:"vin",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsx(N,{children:"VIN"}),e.jsx(b,{children:e.jsx(M,{placeholder:"Enter VIN",...s})}),e.jsx(P,{})]})}),e.jsx(g,{control:a.control,name:"make",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsx(N,{children:"Make"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(b,{children:e.jsx(C,{className:"w-[250px]",children:e.jsx(R,{placeholder:"Select"})})}),e.jsxs(O,{children:[e.jsx(t,{value:"audi",children:"Audi"}),e.jsx(t,{value:"vw",children:"Volkswagen"})]})]})]})}),e.jsx(g,{control:a.control,name:"year",render:({field:s})=>e.jsxs(v,{className:"flex flex-col space-y-1",children:[e.jsx(N,{children:"Year"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(b,{children:e.jsx(C,{className:"w-[250px]",children:e.jsx(R,{placeholder:"Select"})})}),e.jsx(O,{children:Array.from({length:25},(D,i)=>e.jsx(t,{value:`${2025-i}`,children:2025-i},i))})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:e.jsx(g,{control:a.control,name:"model",render:({field:s})=>e.jsxs(v,{children:[e.jsx(N,{children:"Model"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(b,{children:e.jsx(C,{children:e.jsx(R,{placeholder:"Select"})})}),e.jsxs(O,{children:[e.jsx(t,{value:"q5",children:"Q5"}),e.jsx(t,{value:"a4",children:"A4"}),e.jsx(t,{value:"tt",children:"TT"})]})]})]})})})]}),e.jsx(_,{}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-foreground"}),e.jsx("h3",{className:"text-lg font-medium",children:"Attachments"})]}),e.jsxs("div",{className:"grid gap-8 md:grid-cols-2",children:[e.jsx(k,{title:"Structural Measurements",icon:T,files:F,onFilesChange:d,accept:".pdf,.doc,.docx"}),e.jsx(k,{title:"Pre-Repair Photos",icon:W,files:u,onFilesChange:y,accept:"image/*"})]})]})]})})}),e.jsxs(ve,{className:"mt-4 flex-shrink-0 gap-3 border-t pt-4",children:[e.jsx(V,{type:"button",variant:"outline",onClick:j,children:"Cancel"}),e.jsx(V,{form:"repair-order-form",type:"submit",variant:"default",disabled:a.formState.isSubmitting,children:a.formState.isSubmitting?c?"Updating...":"Saving...":c?"Update":"Save"})]})]})})}const U=[...Array(50).fill(0).map((n,l)=>({ro:`810-${l}`,orders:[`SO-1045-${l}`],vin:`AUDIZZZ3BZWE123456-${l}`,vehicle:`2024 Audi Q5-${l}`,status:`CSR Review-${l}`,customer:`Mark Stevenson-${l}`,submitted:`02/27/2025-${l}`,completed:"--",hasAlert:!0}))],ke=n=>n.includes("Rejected")?"destructive":n.includes("Review")?"secondary":n.includes("Processing")?"outline":n.includes("Shipped")?"default":"secondary";function De(){const[n,l]=p.useState(void 0),[A,o]=p.useState(void 0),[c,F]=p.useState(1),d=20,u=U.length,y=Math.ceil(u/d),a=(c-1)*d,I=a+d,j=U.slice(a,I);console.log(`Current Page: ${c}`),console.log(`Data Length to Render: ${j.length}`),console.log(`Total Items: ${u}`);const[k,s]=p.useState(!1),[D,i]=p.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("img",{src:le,alt:"Repair Order List",className:"h-full w-full object-cover"}),e.jsx("div",{className:"border-b bg-background",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Repair Order List"}),e.jsxs(V,{variant:"default",onClick:()=>s(!0),children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"New Repair Order"]})]})}),e.jsx(z,{open:k,onOpenChange:s,onSuccess:r=>{console.log("RO created!",r)}}),e.jsx(z,{open:D,onOpenChange:i,onSuccess:r=>{console.log("Updated:",r)},initialData:{shopRO:"805",customer:"Brian Cooper",vin:"WVWZZZ5CZKK246801",make:"audi",year:"2017",model:"s3",measurementsFiles:[],photoFiles:[],orderFromDealership:"Pacific VW Motors | 88321 (Assigned Dealer)"}}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsxs("div",{className:"lg:items-cente mb-6 flex flex-col items-center gap-4 lg:flex-row",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(ye,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(M,{placeholder:"Filter by RO#, Order #, VIN, Customer",className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs(w,{defaultValue:"all",children:[e.jsx(C,{className:"w-48",children:e.jsx(R,{placeholder:"Status"})}),e.jsxs(O,{children:[e.jsx(t,{value:"all",children:"All Status"}),e.jsx(t,{value:"review",children:"CSR Review"}),e.jsx(t,{value:"processing",children:"Dealer Processing"}),e.jsx(t,{value:"shipped",children:"Dealer Shipped"}),e.jsx(t,{value:"received",children:"Shop Received"}),e.jsx(t,{value:"rejected",children:"CSR Rejected"})]})]}),e.jsxs(w,{defaultValue:"last7",children:[e.jsx(C,{className:"w-40",children:e.jsx(R,{placeholder:"Date Range"})}),e.jsxs(O,{children:[e.jsx(t,{value:"last7",children:"Last 7 Days"}),e.jsx(t,{value:"last30",children:"Last 30 Days"}),e.jsx(t,{value:"custom",children:"Custom Range"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"From"}),e.jsx(B,{selected:n,onSelect:r=>l(r),placeholder:"Select from date"}),e.jsx("span",{className:"text-sm font-medium",children:"To"}),e.jsx(B,{selected:A,onSelect:r=>o(r),placeholder:"Select to date"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{id:"show-completed",className:"rounded-full"}),e.jsx(q,{htmlFor:"show-completed",className:"cursor-pointer text-sm font-medium",children:"Show Repair Completed"})]})]})]}),e.jsx("div",{className:"overflow-hidden rounded-lg border bg-card shadow-sm",children:e.jsxs(ie,{children:[e.jsx(de,{children:e.jsxs(Z,{className:"bg-muted",children:[e.jsx(x,{className:"font-semibold text-foreground",children:"RO #"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Order #"}),e.jsx(x,{className:"font-semibold text-foreground",children:"VIN"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Year/Make/Model"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Status"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Customer"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Date Submitted"}),e.jsx(x,{className:"font-semibold text-foreground",children:"Date Completed"})]})}),e.jsx(me,{children:j.map(r=>e.jsxs(Z,{className:"hover:bg-muted/50",children:[e.jsx(h,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.hasAlert&&e.jsx(Se,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"cursor-pointer text-primary hover:underline",children:r.ro})]})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-1",children:r.orders.map(S=>e.jsx("div",{children:S},S))})}),e.jsx(h,{className:"font-mono text-sm",children:r.vin}),e.jsx(h,{children:r.vehicle}),e.jsx(h,{children:e.jsx(ne,{variant:ke(r.status),className:"whitespace-nowrap",children:r.status})}),e.jsx(h,{children:r.customer}),e.jsx(h,{children:r.submitted}),e.jsx(h,{className:"text-muted-foreground",children:r.completed})]},r.ro))})]})}),e.jsx(Ne,{currentPage:c,totalPages:y,totalItems:u,itemsPerPage:d,onPageChange:F})]})]})}function ds(){const{isAuthenticated:n,isLoading:l}=re();return l||!n?e.jsx(ae,{}):location.pathname==="/repair_orders"?e.jsx(De,{}):e.jsx(se,{})}export{ds as component};
