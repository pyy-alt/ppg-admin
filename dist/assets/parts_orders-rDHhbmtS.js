import{h as se,r as a,p as te,j as e,B as re,C as ae,q as E,P as le}from"./index-DF39fIja.js";import{O as ne}from"./OrderApi-DU34v_zd.js";import{B as ie}from"./badge-BS8zFS8p.js";import{E as oe,a as de,b as ce,T as me,c as ue,d as he,D as xe}from"./data-table-pagination-CArNkiL2.js";import{I as pe}from"./input-Beg9W2YX.js";import{S as v,a as b,b as N,c as y,d as r}from"./select-BJRIUSWV.js";import{T as je,a as fe,b as T,c as n,d as ge,e as l}from"./table-CPwyJAyW.js";import{T as Se,a as ve,b as be,c as Ne}from"./tooltip-C5yavN7N.js";import{D as L}from"./date-picker-Bc1AWXM2.js";import{D as ye}from"./download-B_4-tzIY.js";import{S as Te}from"./search-rBBBnAww.js";import{u as Re}from"./use-authenticated-BcBeDjF6.js";import{L as Ce}from"./Loading-C8C64_a4.js";import"./chevron-left-64XFlFG2.js";import"./chevron-right-CAHHUv44.js";import"./index-BnUIW6bB.js";import"./index-B6vVFevd.js";import"./index-DJ3P-8yo.js";import"./Combination-CALKROlh.js";import"./index-DLqox5B5.js";import"./index-D8KmP1cX.js";import"./chevron-down-DJg8-_AN.js";import"./check-BwEiyP4O.js";import"./index-2iuGDpoq.js";import"./popover-BES2aR1a.js";import"./x-DO36lSba.js";function De(){const{user:i}=se(s=>s.auth),[d,R]=a.useState(void 0),[x,C]=a.useState(void 0),[o,F]=a.useState("30"),[p,$]=a.useState("all"),[j,M]=a.useState("all"),[f,V]=a.useState("all"),[D,w]=a.useState(1),[g,k]=a.useState(""),[O,q]=a.useState([]),[P,H]=a.useState(0),[Y,u]=a.useState(!1),I=20,Q=Math.ceil(P/I),U=s=>s.includes("Review")||s.includes("Rejected")?"destructive":s.includes("Shipped")||s.includes("Completed")?"default":s.includes("Received")?"secondary":s.includes("Processing")?"outline":"secondary",A=async()=>{if(i){u(!0);try{const s=new ne,t=d?E(d):void 0,S=x?E(x):void 0,c={smartFilter:g};p!=="all"&&(c.filterByPartsOrderNumber=parseInt(p)),j!=="all"&&(c.filterByStatus=j),f!=="all"&&(c.filterByRegionId=parseInt(f));const h=le.create(c);t&&(h.dateSubmittedFrom=t),S&&(h.dateSubmittedTo=S),s.partsOrderSearch(h,{status200:m=>{q(m.partOrders||[]),H(m.totalItemCount||0),u(!1)},error:m=>{u(!1)},status403:m=>{u(!1)}})}catch{u(!1)}}};a.useEffect(()=>{if(!i)return;w(1);const s=setTimeout(()=>{A()},g?500:0);return()=>clearTimeout(s)},[g,p,status,f,o,d,x,i]),a.useEffect(()=>{i&&A()},[D]),a.useEffect(()=>{if(o!=="custom"){const{from:s,to:t}=te(o);R(s),C(t)}},[o]);const B=s=>{if(!s)return"--";const t=typeof s=="string"?new Date(s):s;return isNaN(t.getTime())?"--":t.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})},z=s=>s===0?"Parts Order":s===1?"Supplement 1":s===2?"Supplement 2":s===3?"Supplement 3":`Supplement ${s}`;return e.jsx("div",{className:"min-h-scree",children:e.jsxs("div",{className:"bg-background",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Parts Order List"}),e.jsxs(re,{children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Report"]})]}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsx("div",{className:"mb-6 flex flex-col gap-4 lg:flex-row lg:items-center",children:e.jsxs("div",{className:"relative max-w-md flex-1",children:[e.jsx(Te,{className:"text-muted-foreground absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2"}),e.jsx(pe,{value:g,onChange:s=>k(s.target.value),placeholder:"Filter by RO#, Sales Order #, VIN, Shop, Dealer",className:"pl-10"})]})}),e.jsxs("div",{className:"mb-6 flex flex-wrap items-center gap-3",children:[e.jsxs(v,{value:p,onValueChange:s=>$(s),children:[e.jsx(b,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"Type of Order"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Types"}),e.jsx(r,{value:"0",children:"original Parts Order"}),e.jsx(r,{value:"1",children:"Supplement #1"}),e.jsx(r,{value:"2",children:"Supplement #2"}),e.jsx(r,{value:"3",children:"Supplement #3"})]})]}),e.jsxs(v,{value:j,onValueChange:s=>M(s),children:[e.jsx(b,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"Status"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Status"}),e.jsx(r,{value:"csr-Review",children:"CSR Review"}),e.jsx(r,{value:"csr-rejected",children:"CSR Rejected"}),e.jsx(r,{value:"dealer-processing",children:"Dealer Processing"}),e.jsx(r,{value:"dealer-shipped",children:"Dealer Shipped"}),e.jsx(r,{value:"shop-received",children:"Shop Received"}),e.jsx(r,{value:"repair-completed",children:"Repair Completed"})]})]}),e.jsxs(v,{value:f,onValueChange:s=>V(s),children:[e.jsx(b,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"CSR Region"})}),e.jsxs(y,{children:[e.jsx(r,{value:"all",children:"All Regions"}),i?.regions?.map(s=>e.jsx(r,{value:s.id?.toString()||"",children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Date Submitted Range"}),e.jsxs(v,{value:o,onValueChange:s=>F(s),children:[e.jsx(b,{className:"bg-muted w-48",children:e.jsx(N,{placeholder:"ALL Dates"})}),e.jsxs(y,{children:[e.jsx(r,{value:"7",children:"Past 7 days"}),e.jsx(r,{value:"30",children:"Past 30 Days"}),e.jsx(r,{value:"month-to-date",children:"Month-To-Date"}),e.jsx(r,{value:"quarter-to-date",children:"Quarter-To-Date"}),e.jsx(r,{value:"year-to-date",children:"Year-To-Date"}),e.jsx(r,{value:"last-month",children:"Last Month"}),e.jsx(r,{value:"last-quarter",children:"Last Quarter"}),e.jsx(r,{value:"last-year",children:"Last Year"}),e.jsx(r,{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"From"}),e.jsx(L,{disabled:o!=="custom",selected:d,onSelect:s=>R(s),placeholder:"Select from date"}),e.jsx("span",{className:"text-sm font-medium",children:"To"}),e.jsx(L,{disabled:o!=="custom",selected:x,onSelect:s=>C(s),placeholder:"Select to date"})]})]}),e.jsx("div",{className:"bg-background overflow-hidden rounded-lg border shadow-sm",children:e.jsxs(je,{children:[e.jsx(fe,{children:e.jsxs(T,{className:"bg-muted",children:[e.jsx(n,{className:"text-foreground font-semibold",children:"RO #"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Sales #"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Type"}),e.jsx(n,{className:"text-foreground font-semibold",children:"VIN"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Year/Make/Model"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Status"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Shop"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Dealer"}),e.jsx(n,{className:"text-foreground font-semibold",children:"CSR Region"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Date Completed"}),e.jsx(n,{className:"text-foreground font-semibold",children:"Date Closed"})]})}),e.jsx(ge,{children:Y?e.jsx(T,{children:e.jsx(l,{colSpan:11,className:"py-8 text-center",children:"loading..."})}):O.length===0?e.jsx(T,{children:e.jsx(l,{colSpan:11,className:"py-8 text-center",children:e.jsx(oe,{children:e.jsxs(de,{children:[e.jsx(ce,{variant:"icon",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(ue,{children:"No data to display"}),e.jsx(he,{children:"There are no records in this table yet. Add your first entry to get started."})]})})})}):O.map(s=>{const t=s.repairOrder,S=t?.roNumber||"--",c=s.salesOrderNumber||"--",h=z(s.partsOrderNumber||0),m=t?.vin||"--",G=t&&`${t.year||""} ${t.make||""} ${t.model||""}`.trim()||"--",J=s.status||"--",K=t?.shop?`${t.shop.name||""} (${t.shop.id||""})`:"--",W=t?.dealership?`${t.dealership.name||""} (${t.dealership.id||""})`:"--",X=t?.region||"--",Z=B(s.dateReceived),_=B(t?.dateClosed),ee=t?.orderFromAlternateDealership||!1;return e.jsxs(T,{className:"hover:bg-muted/50",children:[e.jsx(l,{className:"text-primary font-medium",children:S}),e.jsx(l,{children:c}),e.jsx(l,{children:h}),e.jsx(l,{className:"font-mono text-xs",children:m}),e.jsx(l,{children:G}),e.jsx(l,{children:e.jsx(ie,{variant:U(j),className:"whitespace-nowrap",children:J})}),e.jsx(l,{className:"text-sm",children:K}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[ee&&e.jsx(Se,{children:e.jsxs(ve,{children:[e.jsx(be,{asChild:!0,children:e.jsx(ae,{className:"h-4 w-4 cursor-help text-yellow-600"})}),e.jsx(Ne,{children:e.jsx("p",{children:"Ordered from an alternate dealer"})})]})}),e.jsx("span",{className:"text-sm",children:W})]})}),e.jsx(l,{children:X}),e.jsx(l,{children:Z}),e.jsx(l,{children:_||"--"})]},s.id)})})]})}),e.jsx(xe,{currentPage:D,totalPages:Q,totalItems:P,itemsPerPage:I,onPageChange:w})]})]})})}function es(){const{isAuthenticated:i,isLoading:d}=Re();return d||!i?e.jsx(Ce,{}):e.jsx(De,{})}export{es as component};
