import{o as C,b as I,i as q,aI as U,r as t,A,t as a,j as e,L as d,p as B,B as V,aO as E}from"./index-Bkm0i40-.js";import{I as w}from"./input-DaKq_e4d.js";import{L as j}from"./label-BN8Qe8K3.js";import{L as F}from"./Loading-Z72NCMiE.js";import{H as y,L as N}from"./header-Vf3flhB_.js";import"./index-CnmrjRy4.js";import"./PersonApi-BZdXp9je.js";import"./ViewTeamDialog-CoFVDWax.js";import"./badge-MEVRXxP2.js";import"./dialog-DSGLXfvZ.js";import"./index-CN5U3HPo.js";import"./Combination-K-YKTF--.js";import"./index-BeLrdImO.js";import"./x-CsoNbFna.js";import"./separator-Bthd58uT.js";import"./users-uvAbHv3x.js";import"./dropdown-menu-BJ11OL3K.js";import"./index-Dt-JkpPh.js";import"./index-CM-w1TYN.js";import"./index-B51CDgwY.js";import"./index-tCO809zo.js";import"./check-BRFXV1aI.js";import"./chevron-right-C97o7tEJ.js";import"./form-FwhVnNbA.js";const v=new A;function $(){const c=C("login","_a.png"),b=I(),{auth:u}=q(),{id:m,guid:p,hash:f}=U({from:"/password/reset/$id/$guid/$hash"}),[r,n]=t.useState(!1),[k,i]=t.useState(!0),[L,x]=t.useState(!1),[o,P]=t.useState(""),[h,S]=t.useState(""),l=t.useRef(!1);t.useEffect(()=>{l.current||(l.current=!0,v.sessionCreate(m,p,f,{status200:s=>{u.setUser(s),x(!0),i(!1)},status404:()=>{a.error("Reset link is invalid or has expired."),x(!1),i(!1)},error:()=>{a.error("Failed to validate reset link. Please try again."),i(!1),l.current=!1}},null))},[m,p,f]);const R=async s=>{if(s.preventDefault(),o!==h){a.error("Passwords do not match.");return}if(o.length<8){a.error("Password must be at least 8 characters.");return}n(!0);try{const g=E.create({newPassword:o});v.updatePassword(g,{status200:()=>{a.success("Your password has been successfully updated."),u.reset(),b({to:"/login"}),n(!1)}})}catch{a.error("Failed to reset password. Please try again."),n(!1)}};return k?e.jsx(F,{}):L?e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(y,{isShowUser:!1}),e.jsx("div",{style:{backgroundImage:`url(${B})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},className:"flex flex-col items-center justify-center px-6 py-12 lg:py-16",children:c?e.jsx("img",{loading:"lazy",src:c,alt:"logo",className:"mx-auto h-36 w-auto max-w-lg space-y-8 text-center drop-shadow-xl lg:h-56"}):null}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4 py-8",children:e.jsx("div",{className:"w-full max-w-md space-y-10",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("h1",{className:"text-foreground text-center text-3xl font-bold",children:"Change Password"}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"password",className:"text-foreground text-sm font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2"}),e.jsx(w,{id:"password",type:"password",placeholder:"Enter new password",className:"h-12 rounded-full pl-11 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:o,onChange:s=>P(s.target.value),required:!0,disabled:r})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirm",className:"text-foreground text-sm font-medium",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-1/2 left-3 h-5 w-5 -translate-y-1/2"}),e.jsx(w,{id:"confirm",type:"password",placeholder:"Confirm new password",className:"h-12 rounded-full pl-11 focus:border-cyan-500 focus:ring-2 focus:ring-cyan-100",value:h,onChange:s=>S(s.target.value),required:!0,disabled:r})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(d,{to:"/login",className:"text-sm font-medium text-cyan-600 transition-colors hover:text-cyan-700",children:"Back to Login"})}),e.jsx(V,{type:"submit",variant:"default",className:"h-12 w-full rounded-full font-medium shadow-md transition-all",disabled:r,children:r?"Updating...":"Update"})]})]})})})]}):e.jsxs("div",{className:"bg-background flex min-h-screen flex-col",children:[e.jsx(y,{isShowUser:!1}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"w-full max-w-md space-y-6 text-center",children:[e.jsx("h1",{className:"text-foreground text-2xl font-bold",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-muted-foreground",children:"The password reset link is invalid or has expired. Please request a new one."}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(d,{to:"/password/forgot",className:"rounded-full px-4 py-2 transition-colors",children:"Request New Link"}),e.jsx(d,{to:"/login",className:"text-foreground hover:bg-muted/50 rounded-full border px-4 py-2 transition-colors",children:"Back to Login"})]})]})})]})}const de=()=>e.jsx($,{});export{de as component};
