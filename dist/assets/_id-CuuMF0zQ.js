import{a as ee,j as e,z as se,r as C,B as S,p as B,t as w,H as me,I as ue,W as ye,au as we,h as he,aC as Se,aD as X}from"./index-AEJqH7X3.js";import{O as L}from"./OrderApi-tF58TuwI.js";import{u as fe,F as ge,U as je,C as Re,n as Oe,R as Ce}from"./RepairOrderDialog-Cenz91-e.js";import{D as de,a as le,b as ie,c as oe,e as Pe}from"./dialog-VSGVEgcW.js";import{L as N,u as ke,a as Fe,g as Ae,F as Ie,b as Me,c as Te,e as $e,f as _e}from"./form-B-9o-mGd.js";import{S as U}from"./separator-Dq2d3GQ3.js";import{X as H}from"./x-jFcJKXCZ.js";import{T as ve}from"./trash-2-DkKAZU2-.js";import{I as re}from"./input-CmFiA4aS.js";import{T as Ee}from"./textarea-BmrtteTy.js";import{C as Q}from"./check-Cpyw8Zmg.js";import{u as qe}from"./use-dialog-with-confirm-CLZ9Cwvb.js";import{P as Ne}from"./plus-mCRLOGDn.js";import{B as _}from"./badge-DYcg5A6J.js";import{P as xe}from"./pencil-CSkjKHCJ.js";import{T as ze}from"./confirm-dialog-Df1IieQe.js";import"./OrganizationApi-CGUmZATk.js";import"./Combination-sHhQTmF-.js";import"./index-DHA2SvWU.js";import"./index-DJLl_0xC.js";import"./select-B7z5Rueb.js";import"./index-CeOSSZ_G.js";import"./index-CbndJyd8.js";import"./index-R1KfRK_v.js";import"./chevron-down-BZo0FCjN.js";import"./index-DyU3SkHl.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],te=ee("loader-circle",De);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],ae=ee("notebook-pen",Le);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],J=ee("package",Ue);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],be=ee("paperclip",We);function ne({className:p,...g}){return e.jsx("div",{"data-slot":"card",className:se("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",p),...g})}function Be({className:p,...g}){return e.jsx("div",{"data-slot":"card-header",className:se("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",p),...g})}function Ye({className:p,...g}){return e.jsx("div",{"data-slot":"card-title",className:se("leading-none font-semibold",p),...g})}function Ve({className:p,...g}){return e.jsx("div",{"data-slot":"card-content",className:se("px-6",p),...g})}function He({open:p,onOpenChange:g,onComplete:m}){const[a,k]=C.useState([new File(["file_name.pdf"],"file_name.pdf",{type:"application/pdf"}),new File(["file_name.pdf"],"file2_name.pdf",{type:"application/pdf"}),new File(["file_name.pdf"],"file3_name.pdf",{type:"application/pdf"})]),{getRootProps:h,getInputProps:A,isDragActive:u}=fe({accept:{"image/*":[]},onDrop:j=>{k(v=>[...v,...j])}}),O=j=>{k(v=>v.filter((b,I)=>I!==j))},t=()=>{a.length!==0&&(m?.(a),g(!1))},x=()=>{k([]),g(!1)};return e.jsx(de,{open:p,onOpenChange:x,children:e.jsxs(le,{className:"flex max-h-[90vh] flex-col p-0 sm:max-w-4xl",children:[e.jsxs(ie,{className:"flex-shrink-0",children:[e.jsx(oe,{className:"px-6 py-4 text-2xl font-semibold",children:"Mark Repair as Complete"}),e.jsx(U,{}),e.jsxs("button",{onClick:x,className:"ring-offset-background focus:ring-ring absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("div",{className:"min-h-0 flex-1 space-y-10 overflow-y-auto p-6 pt-8",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(ge,{className:"text-muted-foreground h-6 w-6"}),"Repair Order Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-12 gap-y-6 text-sm sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Shop RO#"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:"805"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Ordered From Dealership"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:"Pacific Motors (98321)"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Customer"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:"Brian Cooper"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"VIN"}),e.jsx("p",{className:"text-foreground mt-1.5 font-mono",children:"AUDIZZ5CZKK246801"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Year/Make/Model"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:"2017 Audi S3 Sedan"})]})]})]}),e.jsx(U,{className:"bg-border/60"}),e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(be,{className:"text-muted-foreground h-6 w-6"}),"Attachments"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{className:"text-foreground font-medium",children:["Post-Repair Photos ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{...h(),className:`relative cursor-pointer rounded-lg border-2 border-dashed p-12 text-center transition-all ${u?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:[e.jsx("input",{...A()}),e.jsx(je,{className:"text-muted-foreground mx-auto mb-4 h-12 w-12"}),e.jsxs("p",{className:"text-muted-foreground",children:["Drop your photos here or"," ",e.jsx("span",{className:"text-primary font-medium hover:underline",children:"click to browse"})]})]}),e.jsxs(S,{variant:"outline",size:"sm",className:"w-fit",children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),"Open camera"]})]}),e.jsx("div",{children:a.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:a.map((j,v)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md p-1.5",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"text-left",children:e.jsx("p",{className:"max-w-xs truncate text-sm font-medium text-blue-500 hover:underline",children:j.name})})}),e.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),O(v)},className:"text-destructive hover:bg-destructive/10 rounded p-1",children:e.jsx(ve,{className:"h-4 w-4"})})]},v))})})]})]}),e.jsxs("div",{className:"bg-muted/30 flex items-center justify-end gap-3 border-t px-6 py-4",children:[e.jsx(S,{variant:"outline",size:"lg",onClick:x,children:"Cancel"}),e.jsx(S,{size:"lg",className:"bg-black px-8 font-medium text-white hover:bg-black/90",onClick:t,children:"Mark Repair as Complete"})]})]})})}function Ge({open:p,onOpenChange:g,onApprove:m,isReject:a=!1,onReject:k,initRepaitOrderData:h}){const[A,u]=C.useState(""),[O,t]=C.useState(""),[x,j]=C.useState(!1),v=()=>new Promise(async b=>{try{if(a){if(!O){w.error("Reason for rejection is required");return}}else if(!A){w.error("Sales order number is required");return}j(!0),a?(await k?.(O),b(void 0)):(await m?.(A),b(void 0)),t(""),u(""),g(!1),b(void 0)}catch(I){w.error(`Failed to ${a?"reject":"approve"} parts order ${I}|`),b(void 0)}finally{j(!1)}});return e.jsx(de,{open:p,onOpenChange:g,children:e.jsxs(le,{className:"max-h-screen overflow-y-auto sm:max-w-5xl",children:[e.jsxs(ie,{children:[e.jsxs(oe,{className:"flex items-center gap-3 text-2xl font-semibold",children:[a?e.jsx(H,{className:"h-7 w-7 rounded-full bg-red-500 p-1 text-white"}):e.jsx(Q,{className:"h-7 w-7 rounded-full bg-green-500 p-1 text-white"}),a?"Parts Order Rejected":"Parts Order Approved"]}),e.jsx(U,{}),e.jsxs("button",{onClick:()=>g(!1),className:"focus:ring-ring absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsxs("div",{className:"space-y-10 p-6 pt-8",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(ge,{className:"text-muted-foreground h-6 w-6"}),"Repair Order Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-12 gap-y-6 text-sm sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Shop RO#"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:h?.roNumber||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Ordered From Dealership"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:h?.dealership?.name||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Customer"}),e.jsx("p",{className:"text-foreground mt-1.5 font-medium",children:h?.customer||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"VIN"}),e.jsx("p",{className:"text-foreground mt-1.5 font-mono",children:h?.vin||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Year/Make/Model"}),e.jsxs("p",{className:"text-foreground mt-1.5 font-medium",children:[h?.year,"/",h?.make,"/",h?.model]})]})]})]}),e.jsx(U,{className:"bg-border/60"}),e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(J,{className:"text-muted-foreground h-6 w-6"}),"Parts Order Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-12 gap-y-6 text-sm sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Submitted"}),e.jsx("p",{className:"mt-1.5",children:B(h?.dateLastSubmitted)||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Approved"}),e.jsx("p",{className:"mt-1.5 font-medium",children:B(h?.dateClosed)||"--"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Shipped"}),e.jsx("p",{className:"text-muted-foreground mt-1.5",children:h?.dealership.name||"--"})]})]})]}),e.jsx(U,{className:"bg-border/60"}),a?e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(ae,{className:"text-muted-foreground h-6 w-6"}),"Reason for Rejection"]}),e.jsx(Ee,{value:O,onChange:b=>t(b.target.value),id:"sales-order",placeholder:"Provied a reason for rejection",className:"mt-2 h-11"})]}):e.jsxs("section",{children:[e.jsxs("h3",{className:"mb-6 flex items-center gap-3 text-lg font-medium",children:[e.jsx(ae,{className:"text-muted-foreground h-6 w-6"}),"Sales Order #"]}),e.jsxs("div",{className:"max-w-sm",children:[e.jsx(N,{htmlFor:"sales-order",className:"text-muted-foreground",children:"Assign a Sales Order #"}),e.jsx(re,{id:"sales-order",placeholder:"Enter sales order number (e.g. SO-174)",className:"mt-2 h-11",value:A,onChange:b=>u(b.target.value.trim())})]})]})]}),e.jsxs("div",{className:"bg-muted/30 flex items-center justify-end gap-3 border-t px-6 py-4",children:[e.jsx(S,{variant:"outline",size:"lg",onClick:()=>g(!1),children:"Cancel"}),e.jsx(S,{size:"lg",className:a?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",onClick:v,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Rejecting...":"Approving..."]}):a?"Reject":"Approve"})]})]})})}const Ze=me({parts:ye(me({number:ue().min(1,"Part number is required")})),_estimateFile:ue().optional()});function Ke({open:p,onOpenChange:g,isReject:m=!1,initialData:a,mode:k="create",initRepaitOrderData:h,onSuccess:A,onHandleResubmit:u}){const[O,t]=C.useState([]),x=ke({resolver:Fe(Ze),defaultValues:{parts:[{number:""},{number:""},{number:""},{number:""}]}}),[j,v]=C.useState(!1),[b,I]=C.useState(""),{handleCloseRequest:F,ConfirmDialogComponent:M}=qe({form:x,hasUnsavedFiles:O.length>0,onClose:()=>{x.reset(),t([]),g(!1)},title:"Discard Changes?",description:"You have unsaved changes. Are you sure you want to close? All your changes will be lost."}),q=()=>{F()},z=c=>c?!0:(F(),!1),{fields:D,append:T,remove:W}=Ae({control:x.control,name:"parts"}),$=a?.partsOrderNumber!==void 0&&a.partsOrderNumber>0,d=()=>{if(m)return"Resubmit Parts Order";if($){const c=a?.partsOrderNumber||1;return a.parts&&a.parts?.length>0?`Edit Supplement #${c}`:`New Supplement #${c}`}else return a&&a?.id?"Edit Parts Order":"New Parts Order"},G=()=>$?`Supplement #${a?.partsOrderNumber||1} Information`:"Parts Order Information";C.useEffect(()=>{if(p&&a){const c=a.parts&&a.parts.length>0?a.parts.map(s=>({number:s})):[{number:""}];x.reset({parts:c.length>0?c:[{number:""}]}),setTimeout(()=>{t(a.estimateFileAssets||[])},0)}else p&&k==="create"&&(x.reset({parts:[{number:""},{number:""},{number:""},{number:""}]}),t([]))},[p,a,k,x]);const Y=c=>{try{const s=new L,n=we.create({...a,parts:c.parts.map(l=>l.number),estimateFileAssets:O,repairOrder:h});return v(!0),new Promise((l,i)=>{s.partsOrderSave(n,{status200:()=>{w.success("Parts Order saved successfully"),g(!1),A?.(),v(!1),l(void 0)},error:o=>{w.error("Error saving parts order:",o),v(!1),i(void 0)},else:(o,f)=>{w.error(f),v(!1),i(void 0)}})})}catch(s){v(!1),w.error("Error saving parts order:",s)}},{getRootProps:Z,getInputProps:K,isDragActive:V}=fe({accept:{"application/pdf":[".pdf"]},onDrop:c=>{t(s=>[...s,...c])}}),r=c=>{t(s=>s.filter((n,l)=>l!==c))};return e.jsxs(e.Fragment,{children:[e.jsx(de,{open:p,onOpenChange:c=>z(c),children:e.jsxs(le,{className:"flex max-h-[90vh] flex-col p-0 sm:max-w-4xl",children:[e.jsxs(ie,{className:"flex-shrink-0",children:[e.jsx(oe,{className:"px-6 py-4 text-2xl font-semibold",children:d()}),e.jsx(U,{}),e.jsxs("button",{onClick:q,className:"ring-offset-background focus:ring-ring absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),e.jsx(Ie,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(Y),className:"flex min-h-0 flex-1 flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:[e.jsxs("section",{className:"mb-8",children:[e.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[e.jsx(J,{className:"text-foreground h-5 w-5"}),e.jsx("h3",{className:"text-foreground text-lg font-semibold",children:"Repair Order Information"})]}),e.jsxs("div",{className:"bg-muted/50 grid grid-cols-1 gap-4 rounded-lg p-5 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground text-xs",children:"Shop RO #"}),e.jsx("p",{className:"font-medium",children:h?.roNumber||"---"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground text-xs",children:"Order From Dealership"}),h?.dealership.name||"---"]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground text-xs",children:"Customer"}),e.jsx("p",{className:"font-medium",children:h?.customer||"---"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground text-xs",children:"VIN"}),e.jsx("p",{className:"font-medium",children:h?.vin||"---"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground text-xs",children:"Year/Make/Model"}),e.jsx("p",{className:"font-medium",children:h?.year&&h?.make&&h?.model?`${h?.year} ${h?.make} ${h?.model}`:"---"})]})]})]}),e.jsx(U,{className:"my-8"}),e.jsxs("section",{className:"mb-8",children:[e.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[e.jsx(J,{className:"text-foreground h-5 w-5"}),e.jsx("h3",{className:"text-foreground text-lg font-semibold",children:G()})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8 text-sm",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Submitted"}),e.jsx("p",{className:"mt-1 font-medium",children:a?.dateSubmitted?B(a?.dateSubmitted):"---"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Approved"}),e.jsx("p",{className:"mt-1 font-medium",children:a?.dateReviewed?B(a?.dateReviewed):"---"})]}),e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Order Shipped"}),e.jsx("p",{className:"mt-1 font-medium",children:a?.dateShipped?B(a?.dateShipped):"---"})]}),a?.id&&a?.salesOrderNumber&&e.jsxs("div",{children:[e.jsx(N,{className:"text-muted-foreground",children:"Sales Order #"}),e.jsx("p",{className:"mt-1 font-medium",children:a.salesOrderNumber||"---"})]})]})]}),e.jsx(U,{className:"my-8"}),e.jsxs("div",{className:"grid grid-cols-1 gap-12 md:grid-cols-2",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[e.jsx(J,{className:"text-foreground h-5 w-5"}),e.jsx("h3",{className:"text-foreground text-lg font-semibold",children:"Requested Part Numbers"})]}),e.jsxs("div",{className:"space-y-4",children:[D.map((c,s)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-muted-foreground w-12 text-sm",children:["Part ",s+1]}),e.jsx(Me,{disabled:a?.status==="DealershipProcessing",control:x.control,name:`parts.${s}.number`,render:({field:n})=>e.jsxs(Te,{className:"flex-1",children:[e.jsx($e,{children:e.jsx(re,{placeholder:"Enter part number",...n})}),e.jsx(_e,{})]})}),D.length>1&&e.jsx(S,{disabled:a?.status==="DealershipProcessing",type:"button",variant:"ghost",size:"icon",onClick:()=>W(s),children:e.jsx(ve,{className:"text-destructive h-4 w-4"})})]},c.id)),e.jsxs(S,{disabled:a?.status==="DealershipProcessing",type:"button",variant:"outline",size:"sm",onClick:()=>T({number:""}),children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"})," Add a Part"]})]})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[e.jsx(be,{className:"text-foreground h-5 w-5"}),e.jsx("h3",{className:"text-foreground text-lg font-semibold",children:"Attachments"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(N,{className:"text-foreground text-sm font-medium",children:["Estimate",(k==="create"||!a?.estimateFileAssets?.length)&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{...Z(),className:`flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed p-10 text-center transition-all ${V?"border-primary bg-muted":"border-border hover:border-primary"}`,children:[e.jsx("input",{...K(),disabled:a?.status==="DealershipProcessing"}),e.jsx(je,{className:"text-muted-foreground mb-3 h-12 w-12"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Drop your PDF files here or"," ",e.jsx("span",{className:"text-primary hover:underline",children:"click to browse"})]})]}),e.jsx("div",{children:O&&O.length>0&&e.jsx("div",{className:"w-full space-y-2",children:O.map((c,s)=>e.jsxs("div",{className:"flex items-center justify-between rounded-md p-1.5",children:[e.jsx("div",{className:"flex-1 truncate",title:c.name,children:e.jsx("p",{className:"cursor-pointer truncate text-sm font-medium text-blue-500 hover:underline",children:c.name})}),e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),r(s)},className:"text-destructive ml-2 text-xs hover:underline",children:"Remove"})]},`${c.name}-${s}`))})}),x.formState.errors._estimateFile&&e.jsx("p",{className:"text-destructive text-sm",children:x.formState.errors._estimateFile.message})]})]})]}),e.jsx("div",{children:m&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"flex items-center gap-3 text-lg font-medium",children:[e.jsx(ae,{className:"text-muted-foreground h-5 w5"}),"Comment"]}),e.jsx(re,{type:"textarea",placeholder:"Enter comment",value:b,className:"mt-2 h-11",onChange:c=>I(c.target.value)})]})})]}),e.jsx(Pe,{className:"bg-muted/50 w-full flex-shrink-0 border-t px-6 py-4 backdrop-blur",children:e.jsxs("div",{className:"flex w-full justify-end gap-3",children:[e.jsx(S,{type:"button",variant:"outline",onClick:q,children:"Cancel"}),m?e.jsxs(S,{type:"button",onClick:async()=>{v(!0),await Y(x.getValues()),await u?.(b),v(!1)},disabled:j,children:[j?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),"Resubmitting..."]}):"Resubmit","Resubmit"]}):e.jsx(S,{type:"submit",variant:"default",disabled:j||x.formState.isSubmitting,children:j||x.formState.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"mr-2 h-4 w-4 animate-spin"}),a?.id?"Updating...":"Saving..."]}):a?.id?"Update":"Save"})]})})]})})]})}),M]})}const pe=["OrderReview","OrderFulfillment","OrderReceived","RepairCompleted"],E=p=>{if(!p)return"";const g=typeof p=="string"?new Date(p):p;return isNaN(g.getTime())?"":g.toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},y=p=>p?`${p.firstName||""} ${p.lastName||""}`.trim():"";function Xe({partsOrder:p,onResubmit:g,onMarkReceived:m,onMarkShipped:a,onApprove:k,onReject:h}){const{auth:A}=he(),u=A.user?.person?.type;if(!p)return e.jsxs(ne,{className:"p-6",children:[e.jsx("h2",{className:"mb-6 text-2xl font-bold",children:"Parts Tracker"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No parts order data available"})]});const{stage:O,status:t,approvalFlag:x,dateSubmitted:j,dateReviewed:v,dateShipped:b,dateReceived:I,submittedByPerson:F,reviewedByPerson:M,shippedByPerson:q,receivedByPerson:z,orderReviewActivityLogItems:D,orderFulfillmentActivityLogItems:T,orderReceivedActivityLogItems:W}=p,d=(()=>{const r=D&&D?.length>0?D:T&&T?.length>0?T:W&&W?.length>0?W:[],c=r.find(R=>R?.type==="Submitted"),s=r.find(R=>R?.type==="Rejected"),n=r.find(R=>R?.type==="Resubmitted"),l=r.find(R=>R?.type==="Approved"),i=r.find(R=>R?.type==="Shipped"),o=r.find(R=>R?.type==="Unshipped"),f=r.find(R=>R?.type==="Received"),P=r.find(R=>R?.type==="Unreceived");return{submitted:c,rejected:s,resubmitted:n,approved:l,shipped:i,unshipped:o,received:f,unreceived:P}})(),G=()=>["OrderReview","OrderFulfillment","OrderReceived"],Y=()=>{const r=[];let c=O||"OrderReview";O==="OrderFulfillment"&&t==="DealershipShipped"&&b&&(c="OrderReceived"),O==="OrderReceived"&&(t==="ShopReceived"||t==="RepairCompleted")&&I&&(c="RepairCompleted");const s=pe.indexOf(c);return G().forEach(l=>{const i=pe.indexOf(l);let o,f,P,R=!1,ce=!1;i<s?(o="completed",l==="OrderReview"&&(x===!0||x===!1?(f=v,P=y(M)):(f=j,P=y(F))),l==="OrderFulfillment"&&t==="DealershipShipped"&&b&&(f=b,P=y(q))):i===s&&(l==="OrderReview"?(f=j,P=y(F),x===!0?(o="approved",f=v,P=y(M)):x===!1?(o="rejected",f=v,P=y(M)):t==="CsrReview"&&(o="waiting",R=!0,ce=!0)):l==="OrderFulfillment"?(f=v,P=y(M),t==="DealershipProcessing"||t==="DealershipShipped"?t==="DealershipShipped"?(f=b,P=y(q),o="completed"):o="waiting":t==="CsrReview"&&x===!0&&(o="waiting")):l==="OrderReceived"?(f=b,P=y(q),t==="ShopReceived"||t==="RepairCompleted"?(o="completed",f=I,P=y(z)):t==="DealershipShipped"&&(o="waiting")):l==="RepairCompleted"&&t==="RepairCompleted"&&(o="completed")),r.push({id:i+1,stage:l,title:Z(l),status:o,date:f,by:P,canApprove:R,canReject:ce})}),r},Z=r=>({OrderReview:"Order Review",OrderFulfillment:"Order Fulfillment",OrderReceived:"Order Received",RepairCompleted:"Repair Completed"})[r],K=r=>u==="Csr"&&r.stage==="OrderReview"&&t==="CsrReview"&&r.status==="waiting"?e.jsx(_,{className:"bg-blue-700 text-white",children:"Waiting on You"}):u==="Csr"&&r.stage==="OrderFulfillment"&&r.status==="waiting"?e.jsx(_,{className:"text-muted bg-orange-400",children:"Pending Dealer"}):u==="Shop"&&r.stage==="OrderReview"&&t==="CsrReview"&&r.status==="waiting"?e.jsx(_,{className:"text-muted bg-orange-400",children:"Pending CSR"}):u==="Shop"&&r.stage==="OrderReview"&&r.status==="rejected"?e.jsx(_,{className:"bg-blue-100 text-blue-700",children:"Waiting on You"}):u==="Shop"&&r.stage==="OrderFulfillment"&&r.status==="waiting"?e.jsx(_,{className:"text-muted bg-orange-400",children:"Pending Dealer"}):u==="Dealership"&&r.stage==="OrderFulfillment"&&r.status==="waiting"?e.jsx(_,{className:"bg-blue-100 text-blue-700",children:"Waiting on You"}):u==="Shop"&&r.stage==="OrderReceived"&&r.status==="waiting"?e.jsx(_,{className:"bg-blue-100 text-blue-700",children:"Waiting on You"}):(u==="Dealership"||u==="Csr")&&r.stage==="OrderReceived"&&r.status==="waiting"?e.jsx(_,{className:"text-muted bg-orange-400",children:"Pending Shop"}):r.status==="waiting"?e.jsx(_,{className:"bg-blue-100 text-blue-700",children:"Waiting on You"}):r.status==="pending"?r.stage==="OrderReview"&&t==="CsrReview"?e.jsx(_,{className:"text-muted bg-orange-400",children:"Pending CSR"}):e.jsx(_,{className:"bg-gray-400 text-white",children:"Pending"}):null,V=Y();return e.jsxs(ne,{className:"p-6",children:[e.jsx("h2",{className:"mb-6 text-2xl font-bold",children:"Parts Tracker"}),e.jsx("div",{className:"space-y-8",children:V.map((r,c)=>{const n=r.stage==="OrderReview"&&r.status==="rejected"&&u==="Shop",l=r.stage==="OrderReceived"&&r.status==="waiting"&&m&&u==="Shop",i=r.stage==="OrderFulfillment"&&(r.status==="waiting"||r.status==="completed"&&t==="DealershipShipped")&&a&&u==="Dealership"&&!I,o=r.canApprove&&r.canReject&&u==="Csr"&&k&&h;return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`flex h-6 w-6 items-center justify-center rounded-full p-1 text-sm font-bold text-white ${r.status==="approved"||r.status==="completed"?"bg-green-600":r.status==="rejected"?"bg-red-500":r.status==="waiting"?"bg-black":"bg-gray-400"}`,children:r.status==="approved"||r.status==="completed"?e.jsx(Q,{className:"h-5 w-5"}):r.status==="rejected"?e.jsx(H,{className:"h-5 w-5"}):r.id}),c<V.length-1&&e.jsx("div",{className:"mt-2 h-full w-px border-l border-gray-300"})]}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsxs("div",{className:"mb-1 flex items-center gap-2 p-2",children:[e.jsx("h3",{className:"font-semibold",children:r.title}),K(r)]}),r.stage==="OrderReview"&&e.jsx("div",{className:"space-y-2 text-sm",children:d?e.jsxs(e.Fragment,{children:[d.submitted&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was Submitted on"," ",e.jsx("strong",{children:E(d.submitted.dateCreated)}),d.submitted.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.submitted.person)})]}),"."]}),d.rejected&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-muted-foreground",children:["Request was"," ",e.jsx("span",{className:"font-semibold text-red-600",children:"Rejected"})," ","on"," ",e.jsx("strong",{children:E(d.rejected.dateCreated)}),d.rejected.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsxs("strong",{children:[y(d.rejected.person),"."]})]})]}),d.rejected.comment&&e.jsxs("p",{className:"text-muted-foreground",children:["(Reason: ",d.rejected.comment,")"]})]}),d.resubmitted&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was Resubmitted on"," ",e.jsx("strong",{children:E(d.resubmitted.dateCreated)}),d.resubmitted.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.resubmitted.person)})]}),"."]}),d.approved&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was"," ",e.jsx("span",{className:"font-semibold text-green-600",children:"Approved"})," ","on"," ",e.jsx("strong",{children:E(d.approved.dateCreated)}),d.approved.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsxs("strong",{children:[y(d.approved.person),"."]})]})]})]}):j&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was Submitted on"," ",e.jsx("strong",{children:E(j)}),F&&e.jsxs(e.Fragment,{children:[" by ",e.jsxs("strong",{children:[y(F),"."]})]})]})}),r.stage==="OrderFulfillment"&&e.jsx("div",{className:"space-y-2 text-sm",children:d?e.jsxs(e.Fragment,{children:[d.shipped&&e.jsxs("p",{className:"text-muted-foreground",children:["Parts were Shipped on"," ",e.jsx("strong",{children:E(d.shipped.dateCreated)}),d.shipped.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.shipped.person)})]})]}),d.unshipped&&e.jsxs("p",{className:"text-muted-foreground",children:["Parts were Unshipped on"," ",e.jsx("strong",{children:E(d.unshipped.dateCreated)}),d.unshipped.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.unshipped.person)})]})]})]}):j&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was Submitted on"," ",e.jsx("strong",{children:E(j)}),F&&e.jsxs(e.Fragment,{children:[" by ",e.jsxs("strong",{children:[y(F),"."]})]})]})}),r.stage==="OrderReceived"&&e.jsx("div",{className:"space-y-2 text-sm",children:d?e.jsxs(e.Fragment,{children:[d.received&&e.jsxs("p",{className:"text-muted-foreground",children:["Parts were Received on"," ",e.jsx("strong",{children:E(d.received.dateCreated)}),d.received.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.received.person)})]})]}),d.unreceived&&e.jsxs("p",{className:"text-muted-foreground",children:["Parts were Unreceived on"," ",e.jsx("strong",{children:E(d.unreceived.dateCreated)}),d.unreceived.person&&e.jsxs(e.Fragment,{children:[" by ",e.jsx("strong",{children:y(d.unreceived.person)})]})]})]}):j&&e.jsxs("p",{className:"text-muted-foreground",children:["Request was Submitted on"," ",e.jsx("strong",{children:E(j)}),F&&e.jsxs(e.Fragment,{children:[" by ",e.jsxs("strong",{children:[y(F),"."]})]})]})}),o&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"mb-3 text-sm",children:"This request is"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:k,children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),"Approved"]}),e.jsxs(S,{size:"sm",className:"bg-red-600 hover:bg-red-700",onClick:h,children:[e.jsx(H,{className:"mr-1 h-4 w-4"}),"Rejected"]})]})]}),n&&e.jsx("div",{className:"mt-4",children:e.jsx(S,{size:"sm",variant:"outline",onClick:g,className:"bg-gray-100 hover:bg-gray-200",children:"Resubmit Request"})}),i&&e.jsx("div",{className:"mt-4",children:e.jsx(S,{size:"sm",variant:"outline",onClick:()=>a(t),className:"bg-gray-100 hover:bg-gray-200",children:t==="DealershipShipped"?"Unmark Parts as Shipped":"Mark Parts as Shipped"})}),l&&e.jsx("div",{className:"mt-4",children:e.jsx(S,{size:"sm",variant:"outline",onClick:()=>m(r.status),className:"bg-gray-100 hover:bg-gray-200",children:"Mark Parts as Received"})})]})]},r.id)})})]})}function Je(){const[p,g]=C.useState(!1),[m,a]=C.useState(),[k,h]=C.useState(!1),A=Se({from:"/_authenticated/repair_orders/$id"}).id,[u,O]=C.useState(),[t,x]=C.useState(),[j,v]=C.useState(0),[b,I]=C.useState(!1),[F,M]=C.useState(!1),[q,z]=C.useState(!1),{auth:D}=he(),T=D.user?.person?.type,W=async()=>{try{return new Promise((s,n)=>{new L().repairOrderGet(A,{status200:i=>{a(i),s(i)},error:i=>{n(i)}})})}catch{}},$=async()=>{try{return new Promise((s,n)=>{new L().partsOrderGetAllForRepairOrder(A,{status200:i=>{Object.prototype.toString.call(i)==="[object Array]"?O(i):O([i]);const o=Object.prototype.toString.call(i)==="[object Array]"?i:[i];x(f=>{if(o.length!==0){if(j>=0&&j<o.length)return o[j];if(f&&f.id!=null){const P=o.find(R=>R.id===f.id);if(P)return P}return o[0]}}),s(i)},error:i=>{w.error("Error:",i),n()},else:(i,o)=>{w.error(o),n()}})})}catch{}},d=async s=>{if(!(!t||!t.id))try{await new Promise((n,l)=>{const i=new L,o=X.create({partsOrderId:t.id,action:"Approved",salesOrderNumber:s});i.partsOrderSubmitWorkflowAction(o,{status200:()=>{w.success("Parts order approved successfully"),$(),n(!0)},error:f=>{w.error(`Failed to approve parts order ${f}|`),l(!1)},else:()=>{l(!1)}})})}catch{}},G=async s=>{if(!(!t||!t.id))try{await new Promise((n,l)=>{const i=new L,o=X.create({partsOrderId:t.id,action:"Rejected",comment:s});i.partsOrderSubmitWorkflowAction(o,{status200:()=>{w.success("Parts order rejected successfully"),$(),n(!0)},error:f=>{w.error(`Failed to reject parts order ${f}|`),l(!1)},else:()=>{l(!1)}})})}catch{}},Y=async s=>{try{await new Promise((n,l)=>{const i=new L,o=X.create({partsOrderId:t.id,action:"Resubmitted",comment:s,salesOrderNumber:t.salesOrderNumber});i.partsOrderSubmitWorkflowAction(o,{status200:()=>{w.success("Parts order resubmitted successfully"),$(),n(!0)},error:f=>{w.error(`Failed to resubmit parts order ${f}|`),l(!1)},else:()=>{l(!1)}})})}catch(n){w.error(`Failed to resubmit parts order ${n}|`)}},Z=()=>{g(!0),z(!0)},K=async s=>{try{await new Promise((n,l)=>{const i=new L,o=X.create({partsOrderId:t.id,action:s==="DealershipShipped"?"Unshipped":"Shipped"});i.partsOrderSubmitWorkflowAction(o,{status200:()=>{w.success("Parts order marked as shipped successfully"),$(),n(!0)},error:f=>{w.error(`Failed to mark parts order as shipped ${f}|`),l(!1)},else:()=>{l(!1)}})})}catch(n){w.error(`Failed to mark parts order as shipped ${n}|`)}},V=async s=>{try{await new Promise((n,l)=>{const i=new L,o=X.create({partsOrderId:t.id,action:s==="DealershipShipped"?"Unreceived":"Received"});i.partsOrderSubmitWorkflowAction(o,{status200:()=>{w.success("Parts order marked as received successfully"),$(),n(!0)},error:f=>{w.error(`Failed to mark parts order as received ${f}|`),l(!1)},else:()=>{l(!1)}})})}catch(n){w.error(`Failed to mark parts order as received ${n}|`)}},r=()=>{M(!0),z(!1)},c=()=>{M(!0),z(!0)};return C.useEffect(()=>{W(),$()},[]),e.jsxs("div",{className:"bg-background text-foreground",children:[e.jsx("div",{className:"mt-8 h-full w-full",children:e.jsx("img",{src:Oe,alt:"Repair Order List",className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"mx-4 my-6 p-3",children:[e.jsxs("div",{className:"flex w-full flex-col rounded-sm border",children:[e.jsxs("div",{className:"bg-muted text-foreground flex w-full items-center justify-between p-5",children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:["Repair Order # :",m?.roNumber||"--"]}),e.jsxs("div",{className:"flex gap-3",children:[u?.every(s=>s.status==="ShopReceived"||s.status==="CsrRejected")&&T==="Shop"?e.jsxs(S,{onClick:()=>h(!0),size:"sm",className:"h-9 bg-green-600 text-xs font-medium",children:[e.jsx(Q,{className:"mr-1.5 h-3.5 w-3.5"}),"Mark Repair as Complete"]}):null,T==="Shop"?e.jsxs(S,{size:"sm",variant:"outline",className:"h-9 text-xs font-medium",onClick:()=>I(!0),children:[e.jsx(xe,{className:"mr-1.5 h-3.5 w-3.5"}),"Edit Repair Order"]}):null]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 p-5 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Customer"}),e.jsx("p",{className:"font-medium",children:m?.customer||"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"VIN"}),e.jsx("p",{className:"font-mono",children:m?.vin||"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Year/Make/Model"}),e.jsxs("p",{className:"font-medium",children:[m?.year,"/",m?.make,"/",m?.model]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Date Submitted"}),e.jsx("p",{children:B(m?.dateLastSubmitted)||"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Submitted To"}),e.jsx("p",{className:"font-medium",children:m?.dealership?.name||"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Date Closed"}),e.jsx("p",{className:"text-muted-foreground",children:B(m?.dateClosed)||"--"})]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Pre-Repair Photos"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:m&&m?.preRepairPhotoFileAssets&&m?.preRepairPhotoFileAssets.length>0?m?.preRepairPhotoFileAssets?.map(s=>e.jsx("a",{href:s.downloadUrl,className:"text-blue-700 underline hover:underline",children:s.filename},s.id)):"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Structural Measurements"}),e.jsx("br",{}),e.jsx("a",{href:"#",className:"text-primary hover:underline",children:m?.structuralMeasurementFileAssets&&m?.structuralMeasurementFileAssets.length>0?m?.structuralMeasurementFileAssets?.map(s=>e.jsx("a",{href:s.downloadUrl,className:"text-blue-700 underline hover:underline",children:s.filename},s.id)):"--"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Post-Repair Photos"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:m?.postRepairPhotoFileAssets&&m?.postRepairPhotoFileAssets.length>0?m?.postRepairPhotoFileAssets?.map(s=>e.jsx("a",{href:s.downloadUrl,className:"text-blue-700 underline hover:underline",children:s.filename},s.id)):"--"})]})]})]})]}),e.jsxs("div",{className:"my-5 flex flex-col rounded-sm border",children:[e.jsxs("div",{className:"bg-muted flex items-center justify-between overflow-hidden p-5",children:[e.jsx("div",{className:"flex items-center gap-6 text-sm font-medium",children:u&&u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:j===0?"default":"outline",size:"sm",onClick:()=>{const s=u.find(n=>n.partsOrderNumber===0);v(0),x(s)},children:"Parts Order"}),u.filter(s=>s.partsOrderNumber&&s.partsOrderNumber>0).map((s,n)=>e.jsxs(S,{variant:j===n+1?"default":"outline",onClick:()=>{x(s),v(n+1)},children:[s.hasAlert&&e.jsx(ze,{className:"text-destructive h-4 w-4"}),"Supplement ",s.partsOrderNumber]},s.id||n))]})}),u?.every(s=>s.status==="RepairCompleted"||s.status==="CsrRejected"||s.status==="RepairCompleted")&&T==="Shop"&&e.jsxs(S,{onClick:()=>{x(void 0),g(!0),z(!1)},variant:"outline",size:"sm",className:"h-9 rounded-lg font-medium",children:[e.jsx(Ne,{className:"mr-1.5 h-3.5 w-3.5"}),"Supplemental Parts Order"]})]}),e.jsxs("div",{className:"m-5 flex gap-8",children:[e.jsx("div",{className:"max-w-lg flex-1",children:(t||u&&u.length>0&&u[0])&&e.jsxs(ne,{className:"rounded-xl border shadow-sm",children:[e.jsx(Be,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ye,{className:"text-foreground text-base font-semibold",children:["Sales Order #"," ",t?.salesOrderNumber||"--"]}),T==="Shop"&&t?.stage=="OrderReview"&&t?.status!=="DealershipProcessing"||T==="Csr"&&t?.status!=="CsrReview"&&t?.status!=="CsrRejected"?e.jsxs(S,{onClick:()=>{x(t),g(!0)},size:"sm",variant:"outline",className:"h-9 px-4 text-xs",children:[e.jsx(xe,{className:"h-3.5 w-3.5"}),"Edit Parts Order"]}):null]})}),e.jsxs(Ve,{className:"space-y-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-muted-foreground mb-3 font-medium",children:"Requested Parts"}),e.jsx("ol",{className:"text-foreground/90 space-y-2 pl-5 font-mono",children:t?.parts?.length>0&&t?.parts?.map((s,n)=>e.jsxs("li",{children:["(",n+1,") ",s]},s+n))||"-- No parts requested"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Parts Estimate"}),e.jsx("br",{}),t&&t.estimateFileAssets&&t.estimateFileAssets.length>0&&t.estimateFileAssets.map(s=>e.jsx("a",{href:s.viewUrl,className:"text-blue-700 underline hover:underline",children:s.filename},s.id))||"-- No estimate file"]})]})]})||"-- No parts order data"}),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(Xe,{partsOrder:t||u&&u.length>0&&u?.[0],onApprove:r,onReject:c,onResubmit:Z,onMarkShipped:s=>K(s),onMarkReceived:s=>V(s)})})]})]})]}),e.jsx(Ke,{open:p,onOpenChange:g,initialData:t,initRepaitOrderData:m,onSuccess:()=>{$()},isReject:q,onHandleResubmit:Y}),e.jsx(Ge,{open:F,onOpenChange:M,onApprove:d,onReject:G,isReject:q,initRepaitOrderData:m}),e.jsx(He,{open:k,onOpenChange:h}),e.jsx(Ce,{open:b,onOpenChange:I,initialData:m})]})}const Rs=Je;export{Rs as component};
